import{d as xe,f as g,a as m,s as _}from"../chunks/BdGXCaaf.js";import{w as ye,y as B,a7 as ne,t as we,ab as Se,ac as Ae,ad as ke,C as qe,$ as ze,a0 as r,a2 as s,a4 as G,b as n,a3 as O,a5 as Ce,s as A,a8 as Pe,a1 as t}from"../chunks/CKtoZ9Il.js";import{i as J}from"../chunks/CbCO2Vro.js";import{c as $e,s as u,e as ee,t as Ne,d as Oe,b as je}from"../chunks/YsnlS2wf.js";import{h as De}from"../chunks/D6iQrA29.js";import{r as ae,s as te}from"../chunks/C2tPD3ws.js";import{b as re}from"../chunks/CMJw4TJe.js";function se(a,o,v=!1){if(a.multiple){if(o==null)return;if(!Se(o))return Ae();for(var l of a.options)l.selected=o.includes(z(l));return}for(l of a.options){var p=z(l);if(ke(p,o)){l.selected=!0;return}}(!v||o!==void 0)&&(a.selectedIndex=-1)}function Me(a){var o=new MutationObserver(()=>{se(a,a.__value)});o.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),we(()=>{o.disconnect()})}function Te(a,o,v=o){var l=new WeakSet,p=!0;ye(a,"change",c=>{var y=c?"[selected]":":checked",f;if(a.multiple)f=[].map.call(a.querySelectorAll(y),z);else{var C=a.querySelector(y)??a.querySelector("option:not([disabled])");f=C&&z(C)}v(f),B!==null&&l.add(B)}),ne(()=>{var c=o();if(a===document.activeElement){var y=qe??B;if(l.has(y))return}if(se(a,c,p),p&&c===void 0){var f=a.querySelector(":checked");f!==null&&(c=z(f),v(c))}a.__value=c,p=!1}),Me(a)}function z(a){return"__value"in a?a.__value:a.value}var Ee=g('<p class="text-[var(--muted)]">No schedules yet</p>'),Fe=g('<div><div class="flex items-center gap-4"><span class="text-xl font-mono"> </span> <div><span class="font-medium"> </span> <span class="text-sm text-[var(--muted)] ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded bg-red-900 hover:bg-red-800">Delete</button></div></div>'),He=g('<div class="space-y-2"></div>'),Ie=g('<button class="text-sm px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Clear All</button>'),Le=g('<p class="text-[var(--muted)]">No pending actions (all lamps online)</p>'),Re=g('<div class="bg-[var(--card)] border border-[var(--border)] rounded-lg p-3 flex items-center justify-between"><div><span class="font-mono text-sm"> </span> <span class="text-sm text-[var(--muted)] ml-2"> </span></div> <span class="text-xs text-[var(--muted)]"> </span></div>'),We=g('<div class="space-y-2"></div>'),Be=g('<div class="space-y-8"><section class="bg-[var(--card)] border border-[var(--border)] rounded-lg p-4"><h2 class="text-lg font-medium mb-4">Create Schedule</h2> <div class="flex flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2 flex-1 min-w-[150px]"/> <select class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2"><option>Day Mode</option><option>Night Mode</option><option>All Off</option></select> <input type="time" class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2"/> <button class="bg-[var(--accent)] hover:bg-blue-600 disabled:opacity-50 px-4 py-2 rounded">Add</button></div></section> <section><h2 class="text-lg font-medium mb-4"> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium"> </h2> <!></div> <!></section></div>');function Ye(a,o){ze(o,!0);let v=O(""),l=O("night"),p=O("19:00"),c=O(!1);async function y(){if(n(v).trim()){A(c,!0);try{await $e(n(v).trim(),n(l),n(p)),A(v,""),await u.refreshSchedules()}catch(e){console.error(e)}A(c,!1)}}async function f(e){await Oe(e),await u.refreshSchedules()}async function C(e){await Ne(e),await u.refreshSchedules()}async function ie(){await je(),await u.refreshPending()}var j=Be();De("19rgvlq",e=>{ne(()=>{Pe.title="Smart Home - Schedule"})});var D=r(j),K=s(r(D),2),M=r(K);ae(M);var P=s(M,2),T=r(P);T.value=T.__value="day";var E=s(T);E.value=E.__value="night";var Q=s(E);Q.value=Q.__value="off",t(P);var F=s(P,2);ae(F);var U=s(F,2);U.__click=y,t(K),t(D);var H=s(D,2),I=r(H),oe=r(I);t(I);var de=s(I,2);{var le=e=>{var i=Ee();m(e,i)},ve=e=>{var i=He();ee(i,21,()=>u.schedules,h=>h.id,(h,d)=>{var b=Fe();let w;var x=r(b),k=r(x),$=r(k,!0);t(k);var N=s(k,2),S=r(N),W=r(S,!0);t(S);var X=s(S,2),me=r(X);t(X),t(N),t(x);var Y=s(x,2),q=r(Y);q.__click=()=>C(n(d).id);let Z;var ge=r(q,!0);t(q);var he=s(q,2);he.__click=()=>f(n(d).id),t(Y),t(b),G(()=>{w=te(b,1,"bg-[var(--card)] border border-[var(--border)] rounded-lg p-3 flex items-center justify-between",null,w,{"opacity-50":!n(d).enabled}),_($,n(d).time),_(W,n(d).name),_(me,`(${n(d).preset??""})`),Z=te(q,1,"text-sm px-3 py-1 rounded",null,Z,{"bg-green-800":n(d).enabled,"bg-zinc-700":!n(d).enabled}),_(ge,n(d).enabled?"On":"Off")}),m(h,b)}),t(i),m(e,i)};J(de,e=>{u.schedules.length===0?e(le):e(ve,!1)})}t(H);var V=s(H,2),L=r(V),R=r(L),ce=r(R);t(R);var ue=s(R,2);{var pe=e=>{var i=Ie();i.__click=ie,m(e,i)};J(ue,e=>{u.pendingActions.length>0&&e(pe)})}t(L);var _e=s(L,2);{var fe=e=>{var i=Le();m(e,i)},be=e=>{var i=We();ee(i,21,()=>u.pendingActions,h=>h.id,(h,d)=>{var b=Re(),w=r(b),x=r(w),k=r(x,!0);t(x);var $=s(x,2),N=r($);t($),t(w);var S=s(w,2),W=r(S);t(S),t(b),G(()=>{_(k,n(d).device_id),_(N,`â†’ ${n(d).preset??""}`),_(W,`Retry #${n(d).retry_count??""}`)}),m(h,b)}),t(i),m(e,i)};J(_e,e=>{u.pendingActions.length===0?e(fe):e(be,!1)})}t(V),t(j),G(e=>{U.disabled=e,_(oe,`Schedules (${u.schedules.length??""})`),_(ce,`Pending Actions (${u.pendingActions.length??""})`)},[()=>n(c)||!n(v).trim()]),re(M,()=>n(v),e=>A(v,e)),Te(P,()=>n(l),e=>A(l,e)),re(F,()=>n(p),e=>A(p,e)),m(a,j),Ce()}xe(["click"]);export{Ye as component};
