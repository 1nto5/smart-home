import{d as ge,f as x,a as b,s as f}from"../chunks/KsRpIQI_.js";import{l as he,c as z,K as re,t as ye,ab as we,ac as ke,ad as Se,p as Ae,a0 as qe,a1 as r,a3 as s,a5 as B,g as n,a4 as j,a6 as Pe,s as S,a8 as $e,a2 as a}from"../chunks/CxzkeP2L.js";import{i as G}from"../chunks/JY_fI8Mb.js";import{c as Ce,s as u,e as Z,t as Ne,d as Oe,b as je}from"../chunks/C_s4BKAr.js";import{h as De}from"../chunks/jdav0aRx.js";import{r as ee,s as te}from"../chunks/BRTiwp6z.js";import{b as ae}from"../chunks/DvcQTK2l.js";function ne(t,i,c=!1){if(t.multiple){if(i==null)return;if(!we(i))return ke();for(var l of t.options)l.selected=i.includes(P(l));return}for(l of t.options){var p=P(l);if(Se(p,i)){l.selected=!0;return}}(!c||i!==void 0)&&(t.selectedIndex=-1)}function Me(t){var i=new MutationObserver(()=>{ne(t,t.__value)});i.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ye(()=>{i.disconnect()})}function Te(t,i,c=i){var l=new WeakSet,p=!0;he(t,"change",v=>{var y=v?"[selected]":":checked",_;if(t.multiple)_=[].map.call(t.querySelectorAll(y),P);else{var $=t.querySelector(y)??t.querySelector("option:not([disabled])");_=$&&P($)}c(_),z!==null&&l.add(z)}),re(()=>{var v=i();if(t===document.activeElement){var y=Ae??z;if(l.has(y))return}if(ne(t,v,p),p&&v===void 0){var _=t.querySelector(":checked");_!==null&&(v=P(_),c(v))}t.__value=v,p=!1}),Me(t)}function P(t){return"__value"in t?t.__value:t.value}var Ee=x('<p class="text-content-secondary">No schedules yet</p>'),Fe=x('<div><div class="flex items-center gap-4"><span class="text-xl font-mono text-content-primary"> </span> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded-lg bg-error/20 text-error hover:bg-error/30 font-medium transition-colors">Delete</button></div></div>'),He=x('<div class="space-y-2"></div>'),Ie=x('<button class="text-sm px-3 py-1 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors">Clear All</button>'),Ke=x('<p class="text-content-secondary">No pending actions (all lamps online)</p>'),Le=x('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between"><div><span class="font-mono text-sm text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div> <span class="text-xs text-content-tertiary"> </span></div>'),Re=x('<div class="space-y-2"></div>'),We=x('<div class="space-y-8"><section class="bg-surface-elevated border border-stroke-default rounded-xl p-4"><h2 class="text-lg font-medium text-content-primary mb-4">Create Schedule</h2> <div class="flex flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 flex-1 min-w-[150px] text-content-primary placeholder:text-content-tertiary"/> <select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary"><option>Day Mode</option><option>Night Mode</option><option>All Off</option></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary"/> <button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium">Add</button></div></section> <section><h2 class="text-lg font-medium text-content-primary mb-4"> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary"> </h2> <!></div> <!></section></div>');function Xe(t,i){qe(i,!0);let c=j(""),l=j("night"),p=j("19:00"),v=j(!1);async function y(){if(n(c).trim()){S(v,!0);try{await Ce(n(c).trim(),n(l),n(p)),S(c,""),await u.refreshSchedules()}catch(e){console.error(e)}S(v,!1)}}async function _(e){await Oe(e),await u.refreshSchedules()}async function $(e){await Ne(e),await u.refreshSchedules()}async function se(){await je(),await u.refreshPending()}var D=We();De("19rgvlq",e=>{re(()=>{$e.title="Smart Home - Schedule"})});var M=r(D),J=s(r(M),2),T=r(J);ee(T);var C=s(T,2),E=r(C);E.value=E.__value="day";var F=s(E);F.value=F.__value="night";var Q=s(F);Q.value=Q.__value="off",a(C);var H=s(C,2);ee(H);var U=s(H,2);U.__click=y,a(J),a(M);var I=s(M,2),K=r(I),oe=r(K);a(K);var ie=s(K,2);{var le=e=>{var o=Ee();b(e,o)},de=e=>{var o=He();Z(o,21,()=>u.schedules,g=>g.id,(g,d)=>{var m=Fe();let w;var h=r(m),A=r(h),N=r(A,!0);a(A);var O=s(A,2),k=r(O),W=r(k,!0);a(k);var X=s(k,2),me=r(X);a(X),a(O),a(h);var Y=s(h,2),q=r(Y);q.__click=()=>$(n(d).id);var be=r(q,!0);a(q);var xe=s(q,2);xe.__click=()=>_(n(d).id),a(Y),a(m),B(()=>{w=te(m,1,"bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between",null,w,{"opacity-50":!n(d).enabled}),f(N,n(d).time),f(W,n(d).name),f(me,`(${n(d).preset??""})`),te(q,1,`text-sm px-3 py-1 rounded-lg font-medium transition-colors
                       ${n(d).enabled?"bg-success/20 text-success":"bg-surface-recessed text-content-secondary"}`),f(be,n(d).enabled?"On":"Off")}),b(g,m)}),a(o),b(e,o)};G(ie,e=>{u.schedules.length===0?e(le):e(de,!1)})}a(I);var V=s(I,2),L=r(V),R=r(L),ce=r(R);a(R);var ve=s(R,2);{var ue=e=>{var o=Ie();o.__click=se,b(e,o)};G(ve,e=>{u.pendingActions.length>0&&e(ue)})}a(L);var pe=s(L,2);{var fe=e=>{var o=Ke();b(e,o)},_e=e=>{var o=Re();Z(o,21,()=>u.pendingActions,g=>g.id,(g,d)=>{var m=Le(),w=r(m),h=r(w),A=r(h,!0);a(h);var N=s(h,2),O=r(N);a(N),a(w);var k=s(w,2),W=r(k);a(k),a(m),B(()=>{f(A,n(d).device_id),f(O,`â†’ ${n(d).preset??""}`),f(W,`Retry #${n(d).retry_count??""}`)}),b(g,m)}),a(o),b(e,o)};G(pe,e=>{u.pendingActions.length===0?e(fe):e(_e,!1)})}a(V),a(D),B(e=>{U.disabled=e,f(oe,`Schedules (${u.schedules.length??""})`),f(ce,`Pending Actions (${u.pendingActions.length??""})`)},[()=>n(v)||!n(c).trim()]),ae(T,()=>n(c),e=>S(c,e)),Te(C,()=>n(l),e=>S(l,e)),ae(H,()=>n(p),e=>S(p,e)),b(t,D),Pe()}ge(["click"]);export{Xe as component};
