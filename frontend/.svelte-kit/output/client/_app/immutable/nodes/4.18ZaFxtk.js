import{d as xe,f as g,a as m,s as _}from"../chunks/Dlj6haWL.js";import{l as ye,c as W,K as ne,t as we,ab as Se,ac as Ae,ad as ke,p as qe,a0 as ze,a1 as r,a3 as s,a5 as B,g as n,a4 as $,a6 as Pe,s as A,a8 as Ce,a2 as t}from"../chunks/D2JNcFbJ.js";import{i as G}from"../chunks/KdfE8kWJ.js";import{c as Ne,s as u,e as ee,t as Oe,d as $e,b as je}from"../chunks/mhC6JEJ7.js";import{h as De}from"../chunks/CiNAWmNp.js";import{r as ae,s as te}from"../chunks/D0VUfHch.js";import{b as re}from"../chunks/Bd--2Fle.js";function se(a,o,v=!1){if(a.multiple){if(o==null)return;if(!Se(o))return Ae();for(var l of a.options)l.selected=o.includes(z(l));return}for(l of a.options){var p=z(l);if(ke(p,o)){l.selected=!0;return}}(!v||o!==void 0)&&(a.selectedIndex=-1)}function Me(a){var o=new MutationObserver(()=>{se(a,a.__value)});o.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),we(()=>{o.disconnect()})}function Te(a,o,v=o){var l=new WeakSet,p=!0;ye(a,"change",c=>{var y=c?"[selected]":":checked",f;if(a.multiple)f=[].map.call(a.querySelectorAll(y),z);else{var P=a.querySelector(y)??a.querySelector("option:not([disabled])");f=P&&z(P)}v(f),W!==null&&l.add(W)}),ne(()=>{var c=o();if(a===document.activeElement){var y=qe??W;if(l.has(y))return}if(se(a,c,p),p&&c===void 0){var f=a.querySelector(":checked");f!==null&&(c=z(f),v(c))}a.__value=c,p=!1}),Me(a)}function z(a){return"__value"in a?a.__value:a.value}var Ee=g('<p class="text-[var(--muted)]">No schedules yet</p>'),Fe=g('<div><div class="flex items-center gap-4"><span class="text-xl font-mono"> </span> <div><span class="font-medium"> </span> <span class="text-sm text-[var(--muted)] ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded bg-red-900 hover:bg-red-800">Delete</button></div></div>'),He=g('<div class="space-y-2"></div>'),Ie=g('<button class="text-sm px-3 py-1 rounded bg-zinc-700 hover:bg-zinc-600">Clear All</button>'),Ke=g('<p class="text-[var(--muted)]">No pending actions (all lamps online)</p>'),Le=g('<div class="bg-[var(--card)] border border-[var(--border)] rounded-lg p-3 flex items-center justify-between"><div><span class="font-mono text-sm"> </span> <span class="text-sm text-[var(--muted)] ml-2"> </span></div> <span class="text-xs text-[var(--muted)]"> </span></div>'),Re=g('<div class="space-y-2"></div>'),We=g('<div class="space-y-8"><section class="bg-[var(--card)] border border-[var(--border)] rounded-lg p-4"><h2 class="text-lg font-medium mb-4">Create Schedule</h2> <div class="flex flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2 flex-1 min-w-[150px]"/> <select class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2"><option>Day Mode</option><option>Night Mode</option><option>All Off</option></select> <input type="time" class="bg-zinc-800 border border-[var(--border)] rounded px-3 py-2"/> <button class="bg-[var(--accent)] hover:bg-blue-600 disabled:opacity-50 px-4 py-2 rounded">Add</button></div></section> <section><h2 class="text-lg font-medium mb-4"> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium"> </h2> <!></div> <!></section></div>');function Ye(a,o){ze(o,!0);let v=$(""),l=$("night"),p=$("19:00"),c=$(!1);async function y(){if(n(v).trim()){A(c,!0);try{await Ne(n(v).trim(),n(l),n(p)),A(v,""),await u.refreshSchedules()}catch(e){console.error(e)}A(c,!1)}}async function f(e){await $e(e),await u.refreshSchedules()}async function P(e){await Oe(e),await u.refreshSchedules()}async function ie(){await je(),await u.refreshPending()}var j=We();De("19rgvlq",e=>{ne(()=>{Ce.title="Smart Home - Schedule"})});var D=r(j),J=s(r(D),2),M=r(J);ae(M);var C=s(M,2),T=r(C);T.value=T.__value="day";var E=s(T);E.value=E.__value="night";var Q=s(E);Q.value=Q.__value="off",t(C);var F=s(C,2);ae(F);var U=s(F,2);U.__click=y,t(J),t(D);var H=s(D,2),I=r(H),oe=r(I);t(I);var de=s(I,2);{var le=e=>{var i=Ee();m(e,i)},ve=e=>{var i=He();ee(i,21,()=>u.schedules,h=>h.id,(h,d)=>{var b=Fe();let w;var x=r(b),k=r(x),N=r(k,!0);t(k);var O=s(k,2),S=r(O),R=r(S,!0);t(S);var X=s(S,2),me=r(X);t(X),t(O),t(x);var Y=s(x,2),q=r(Y);q.__click=()=>P(n(d).id);let Z;var ge=r(q,!0);t(q);var he=s(q,2);he.__click=()=>f(n(d).id),t(Y),t(b),B(()=>{w=te(b,1,"bg-[var(--card)] border border-[var(--border)] rounded-lg p-3 flex items-center justify-between",null,w,{"opacity-50":!n(d).enabled}),_(N,n(d).time),_(R,n(d).name),_(me,`(${n(d).preset??""})`),Z=te(q,1,"text-sm px-3 py-1 rounded",null,Z,{"bg-green-800":n(d).enabled,"bg-zinc-700":!n(d).enabled}),_(ge,n(d).enabled?"On":"Off")}),m(h,b)}),t(i),m(e,i)};G(de,e=>{u.schedules.length===0?e(le):e(ve,!1)})}t(H);var V=s(H,2),K=r(V),L=r(K),ce=r(L);t(L);var ue=s(L,2);{var pe=e=>{var i=Ie();i.__click=ie,m(e,i)};G(ue,e=>{u.pendingActions.length>0&&e(pe)})}t(K);var _e=s(K,2);{var fe=e=>{var i=Ke();m(e,i)},be=e=>{var i=Re();ee(i,21,()=>u.pendingActions,h=>h.id,(h,d)=>{var b=Le(),w=r(b),x=r(w),k=r(x,!0);t(x);var N=s(x,2),O=r(N);t(N),t(w);var S=s(w,2),R=r(S);t(S),t(b),B(()=>{_(k,n(d).device_id),_(O,`â†’ ${n(d).preset??""}`),_(R,`Retry #${n(d).retry_count??""}`)}),m(h,b)}),t(i),m(e,i)};G(_e,e=>{u.pendingActions.length===0?e(fe):e(be,!1)})}t(V),t(j),B(e=>{U.disabled=e,_(oe,`Schedules (${u.schedules.length??""})`),_(ce,`Pending Actions (${u.pendingActions.length??""})`)},[()=>n(c)||!n(v).trim()]),re(M,()=>n(v),e=>A(v,e)),Te(C,()=>n(l),e=>A(l,e)),re(F,()=>n(p),e=>A(p,e)),m(a,j),Pe()}xe(["click"]);export{Ye as component};
