import{d as Nt,f,a as x,s as u}from"../chunks/zvZFzcKP.js";import{p as Bt,j as b,k as Kt,l as Rt,m as o,n as a,o as r,t as $,v as Et,e as Ft,w as t,$ as It,x as e,y as I,z as qe,A as Ge,f as Ne}from"../chunks/NvR4cXbL.js";import{i as N}from"../chunks/bWZpNnq_.js";import{e as ve,b as Mt,c as Zt,a as y,d as pe,g as zt,r as j,f as Ht,h as Xt,i as qt,u as Gt,t as Jt,j as Qt,k as Ut}from"../chunks/BzB3Y-EY.js";import{c as Vt}from"../chunks/Du68J5SX.js";import{h as Wt,b as B,X as Je,a as Qe,P as Yt}from"../chunks/q6rDPSo1.js";import{b as er}from"../chunks/CmMMdMVi.js";import{L as Ue,Z as tr}from"../chunks/DSlHrGK7.js";import{P as Ve,C as We,a as rr,T as sr}from"../chunks/CJMaAzUP.js";import{P as Ye,M as ar,S as nr}from"../chunks/B-i3jaGQ.js";var or=f('<div class="card card-active glow-lights mb-4"><div class="p-4 space-y-4"><div class="flex flex-col sm:flex-row gap-3"><input type="text" placeholder="Preset ID (e.g. reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/> <input type="text" placeholder="Display name (e.g. Reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/></div> <div class="flex flex-wrap items-center gap-4"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-10 h-6 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-1 left-1 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-content-primary text-sm">Power On</span></label> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Brightness</span> <input type="range" min="1" max="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-12"> </span></div> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Color</span> <input type="range" min="2700" max="6500" step="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-16"> </span></div></div> <div class="flex gap-2"><button class="px-4 py-2.5 rounded-lg glow-lights power-btn-on font-semibold uppercase tracking-wider disabled:opacity-50 transition-all">Create Preset</button> <button class="px-3 py-2.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary hover:border-stroke-strong transition-colors"><!></button></div></div></div>'),lr=f('<div class="space-y-3 pt-2 border-t border-stroke-subtle"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-9 h-5 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-sm text-content-primary">Power</span></label> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Brightness</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="1" max="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Color Temp</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="2700" max="6500" step="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="flex gap-2 pt-1"><button class="flex-1 py-2 rounded-lg bg-success/20 text-success border border-success/30 font-medium text-sm disabled:opacity-50 hover:bg-success/30 transition-colors">Save</button> <button class="px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Cancel</button></div></div>'),ir=f('<span class="font-display"> </span> <span class="text-content-tertiary">/</span> <span class="font-display"> </span>',1),cr=f("<!> <span>Off</span>",1),dr=f('<button class="text-sm text-content-secondary hover:text-device-lights-text transition-colors flex items-center gap-2"><!></button>'),vr=f('<div class="card relative group hover:border-device-lights-text/30 transition-colors"><button class="absolute top-2 right-2 p-1.5 rounded-lg bg-error/10 text-error border border-error/30 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-error/20" title="Delete preset"><!></button> <div class="p-4"><div class="flex items-center justify-between mb-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-lg glow-lights power-btn-on flex items-center justify-center"><!></div> <span class="font-display text-sm uppercase tracking-wider text-content-primary"> </span></div> <button title="Apply to all lamps"><!></button></div> <!></div></div>'),pr=f('<span class="mx-1 text-content-tertiary">/</span> <span class="text-warning"> </span>',1),ur=f('<div class="mt-3 px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-subtle inline-flex items-center gap-2"><!> <span class="text-sm text-content-secondary"><span class="text-success"> </span> <!></span></div>'),gr=f('<option class="svelte-92554t"> </option>'),xr=f('<div class="card p-6 text-center"><!> <p class="text-content-tertiary">No schedules configured</p></div>'),br=f('<div><div class="flex items-center gap-4"><div class="font-display text-2xl text-accent neon-text-subtle"> </div> <div class="h-8 w-px bg-stroke-subtle"></div> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-tertiary ml-2"><span class="text-device-lights-text"> </span></span></div></div> <div class="flex gap-2"><button> </button> <button class="p-1.5 rounded-lg bg-error/10 text-error border border-error/30 hover:bg-error/20 transition-colors"><!></button></div></div>'),fr=f('<div class="space-y-2"></div>'),_r=f('<button class="ml-3 px-3 py-1.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Clear All</button>'),mr=f('<div class="card p-4 flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-success animate-glow"></div> <p class="text-content-secondary text-sm">All lamps online - no pending actions</p></div>'),hr=f('<div class="card p-3 flex items-center justify-between border-warning/30"><div class="flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-warning animate-glow"></div> <span class="font-mono text-sm text-content-primary"> </span> <span class="text-content-tertiary">â†’</span> <span class="text-sm text-device-lights-text"> </span></div> <span class="text-xs font-display text-content-tertiary px-2 py-1 rounded bg-surface-recessed"> </span></div>'),yr=f('<div class="space-y-2"></div>'),wr=f('<div class="space-y-8 pb-24"><section><div class="section-header section-header-lights svelte-92554t"><div class="section-icon glow-lights svelte-92554t"><!></div> <h2 class="section-title svelte-92554t">Lamp Presets</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t"></div> <button class="ml-3 px-3 py-1.5 rounded-lg glow-lights power-btn-on text-sm font-medium flex items-center gap-1.5 transition-transform hover:scale-105"><!> Add</button></div> <!> <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Create Schedule</h2> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <div class="card p-4"><div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary focus:border-accent focus:outline-none transition-colors"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary flex-1 sm:flex-initial focus:border-accent focus:outline-none transition-colors svelte-92554t"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary font-display focus:border-accent focus:outline-none transition-colors"/></div> <button style="--color-accent-glow: var(--color-accent-glow);">Add</button></div></div></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Schedules</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-warning) 15%, transparent); border-color: color-mix(in srgb, var(--color-warning) 30%, transparent); color: var(--color-warning);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-warning);">Pending Actions</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-warning) 40%, transparent) 0%, transparent 100%);"></div> <!></div> <!></section></div>');function Dr(et,tt){Bt(tt,!0);let q=b(Kt({})),se=b(null),M=b(null),K=b(""),ue=b("night"),ge=b("19:00"),w=b(!1),ae=b(null),G=b(100),J=b(4e3),ne=b(!0),Q=b(!1),Z=b(""),z=b(""),U=b(100),V=b(4e3),oe=b(!0);async function le(){o(q,await zt(),!0)}Rt(()=>{er&&le()});function rt(s){switch(s){case"day":return nr;case"night":return ar;case"off":return Ye;default:return Ue}}async function st(s){o(se,s,!0),o(M,null);try{o(M,await qt(s),!0),y.refreshPending()}catch(n){console.error(n)}o(se,null)}function at(s,n){o(ae,s,!0),o(G,n.brightness,!0),o(J,n.colorTemp,!0),o(ne,n.power,!0)}async function nt(s){o(w,!0);try{await Gt(s,r(G),r(J),r(ne)),o(ae,null),await le()}catch(n){console.error(n)}o(w,!1)}function ot(){o(ae,null)}async function lt(){if(!(!r(Z).trim()||!r(z).trim())){o(w,!0);try{const s=r(Z).trim().toLowerCase().replace(/\s+/g,"-");await Ht(s,r(z).trim(),r(U),r(V),r(oe)),o(Z,""),o(z,""),o(U,100),o(V,4e3),o(oe,!0),o(Q,!1),await le()}catch(s){console.error(s),alert(s.message||"Failed to create preset")}o(w,!1)}}async function it(s){if(confirm(`Delete preset "${s}"? This will also delete any schedules using this preset.`)){o(w,!0);try{await Xt(s),await le(),await y.refreshSchedules()}catch(n){console.error(n)}o(w,!1)}}async function ct(){if(r(K).trim()){o(w,!0);try{await Zt(r(K).trim(),r(ue),r(ge)),o(K,""),await y.refreshSchedules()}catch(s){console.error(s)}o(w,!1)}}async function dt(s){await Qt(s),await y.refreshSchedules()}async function vt(s){await Jt(s),await y.refreshSchedules()}async function pt(){await Ut(),await y.refreshPending()}function Be(s){const n=r(q)[s];return(n==null?void 0:n.name)??s}var xe=wr();Wt("92554t",s=>{Ft(()=>{It.title="Smart Home - Lighting"})});var be=t(xe),fe=t(be),_e=t(fe),ut=t(_e);Ue(ut,{class:"w-4 h-4"}),e(_e);var me=a(_e,4),gt=t(me,!0);e(me);var he=a(me,4);he.__click=()=>o(Q,!r(Q));var xt=t(he);Ve(xt,{class:"w-4 h-4"}),I(),e(he),e(fe);var Ke=a(fe,2);{var bt=s=>{var n=or(),c=t(n),l=t(c),i=t(l);j(i);var d=a(i,2);j(d),e(l);var v=a(l,2),_=t(v),h=t(_);j(h),I(4),e(_);var m=a(_,2),g=a(t(m),2);j(g);var k=a(g,2),L=t(k);e(k),e(m);var O=a(m,2),R=a(t(O),2);j(R);var P=a(R,2),C=t(P);e(P),e(O),e(v);var H=a(v,2),T=t(H);T.__click=lt;var E=a(T,2);E.__click=()=>o(Q,!1);var W=t(E);Je(W,{class:"w-5 h-5"}),e(E),e(H),e(c),e(n),$(p=>{u(L,`${r(U)??""}%`),u(C,`${r(V)??""}K`),T.disabled=p},[()=>r(w)||!r(Z).trim()||!r(z).trim()]),B(i,()=>r(Z),p=>o(Z,p)),B(d,()=>r(z),p=>o(z,p)),Qe(h,()=>r(oe),p=>o(oe,p)),B(g,()=>r(U),p=>o(U,p)),B(R,()=>r(V),p=>o(V,p)),x(s,n)};N(Ke,s=>{r(Q)&&s(bt)})}var ye=a(Ke,2);ve(ye,21,()=>Object.entries(r(q)),([s,n])=>s,(s,n)=>{var c=qe(()=>Ge(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=vr(),v=t(d);v.__click=()=>it(l());var _=t(v);Je(_,{class:"w-3 h-3"}),e(v);var h=a(v,2),m=t(h),g=t(m),k=t(g),L=t(k);Vt(L,()=>rt(l()),(p,S)=>{S(p,{class:"w-4 h-4"})}),e(k);var O=a(k,2),R=t(O,!0);e(O),e(g);var P=a(g,2);P.__click=()=>st(l());let C;var H=t(P);Yt(H,{class:"w-4 h-4"}),e(P),e(m);var T=a(m,2);{var E=p=>{var S=lr(),Y=t(S),ce=t(Y);j(ce),I(4),e(Y);var ee=a(Y,2),A=t(ee),D=a(t(A),2),F=t(D);e(D),e(A);var de=a(A,2);j(de),e(ee);var X=a(ee,2),te=t(X),ze=a(t(te),2),Ot=t(ze);e(ze),e(te);var He=a(te,2);j(He),e(X);var Xe=a(X,2),De=t(Xe);De.__click=()=>nt(l());var Dt=a(De,2);Dt.__click=ot,e(Xe),e(S),$(()=>{u(F,`${r(G)??""}%`),u(Ot,`${r(J)??""}K`),De.disabled=r(w)}),Qe(ce,()=>r(ne),re=>o(ne,re)),B(de,()=>r(G),re=>o(G,re)),B(He,()=>r(J),re=>o(J,re)),x(p,S)},W=p=>{var S=dr();S.__click=()=>at(l(),i());var Y=t(S);{var ce=A=>{var D=ir(),F=Ne(D),de=t(F);e(F);var X=a(F,4),te=t(X);e(X),$(()=>{u(de,`${i().brightness??""}%`),u(te,`${i().colorTemp??""}K`)}),x(A,D)},ee=A=>{var D=cr(),F=Ne(D);Ye(F,{class:"w-4 h-4 text-content-tertiary"}),I(2),x(A,D)};N(Y,A=>{i().power?A(ce):A(ee,!1)})}e(S),x(p,S)};N(T,p=>{r(ae)===l()?p(E):p(W,!1)})}e(h),e(d),$(()=>{u(R,i().name),P.disabled=r(se)!==null,C=pe(P,1,"p-2 rounded-lg bg-surface-recessed border border-stroke-default text-device-lights-text hover:glow-lights hover:power-btn-on transition-all disabled:opacity-50",null,C,{"pulse-ring":r(se)===l()})}),x(s,d)}),e(ye);var ft=a(ye,2);{var _t=s=>{var n=ur(),c=t(n);tr(c,{class:"w-4 h-4 text-device-lights-text"});var l=a(c,2),i=t(l),d=t(i);e(i);var v=a(i,2);{var _=h=>{var m=pr(),g=a(Ne(m),2),k=t(g);e(g),$(()=>u(k,`${r(M).pending.length??""} pending`)),x(h,m)};N(v,h=>{r(M).pending.length>0&&h(_)})}e(l),e(n),$(()=>u(d,`${r(M).success.length??""} ok`)),x(s,n)};N(ft,s=>{r(M)&&s(_t)})}e(be);var we=a(be,2),ke=t(we),Re=t(ke),mt=t(Re);Ve(mt,{class:"w-4 h-4"}),e(Re),I(4),e(ke);var Ee=a(ke,2),Fe=t(Ee),Pe=t(Fe);j(Pe);var Ce=a(Pe,2),ie=t(Ce);ve(ie,21,()=>Object.entries(r(q)),([s,n])=>s,(s,n)=>{var c=qe(()=>Ge(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=gr(),v=t(d,!0);e(d);var _={};$(()=>{u(v,i().name),_!==(_=l())&&(d.value=(d.__value=l())??"")}),x(s,d)}),e(ie);var Ie=a(ie,2);j(Ie),e(Ce);var Se=a(Ce,2);Se.__click=ct,e(Fe),e(Ee),e(we);var Ae=a(we,2),$e=t(Ae),je=t($e),ht=t(je);We(ht,{class:"w-4 h-4"}),e(je);var Me=a(je,4),yt=t(Me,!0);e(Me),I(2),e($e);var wt=a($e,2);{var kt=s=>{var n=xr(),c=t(n);We(c,{class:"w-10 h-10 mx-auto text-content-tertiary mb-2 opacity-50"}),I(2),e(n),x(s,n)},Pt=s=>{var n=fr();ve(n,21,()=>y.schedules,c=>c.id,(c,l)=>{var i=br();let d;var v=t(i),_=t(v),h=t(_,!0);e(_);var m=a(_,4),g=t(m),k=t(g,!0);e(g);var L=a(g,2),O=t(L),R=t(O,!0);e(O),e(L),e(m),e(v);var P=a(v,2),C=t(P);C.__click=()=>vt(r(l).id);var H=t(C,!0);e(C);var T=a(C,2);T.__click=()=>dt(r(l).id);var E=t(T);sr(E,{class:"w-4 h-4"}),e(T),e(P),e(i),$(W=>{d=pe(i,1,"card p-3 flex items-center justify-between transition-opacity svelte-92554t",null,d,{"opacity-50":!r(l).enabled,"card-active":r(l).enabled,"glow-accent":r(l).enabled}),u(h,r(l).time),u(k,r(l).name),u(R,W),pe(C,1,`px-3 py-1.5 rounded-lg font-medium text-sm transition-all
                       ${r(l).enabled?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary hover:border-stroke-strong"}`,"svelte-92554t"),u(H,r(l).enabled?"On":"Off")},[()=>Be(r(l).preset)]),x(c,i)}),e(n),x(s,n)};N(wt,s=>{y.schedules.length===0?s(kt):s(Pt,!1)})}e(Ae);var Ze=a(Ae,2),Te=t(Ze),Le=t(Te),Ct=t(Le);rr(Ct,{class:"w-4 h-4"}),e(Le);var Oe=a(Le,4),St=t(Oe,!0);e(Oe);var At=a(Oe,4);{var $t=s=>{var n=_r();n.__click=pt,x(s,n)};N(At,s=>{y.pendingActions.length>0&&s($t)})}e(Te);var jt=a(Te,2);{var Tt=s=>{var n=mr();x(s,n)},Lt=s=>{var n=yr();ve(n,21,()=>y.pendingActions,c=>c.id,(c,l)=>{var i=hr(),d=t(i),v=a(t(d),2),_=t(v,!0);e(v);var h=a(v,4),m=t(h,!0);e(h),e(d);var g=a(d,2),k=t(g);e(g),e(i),$(L=>{u(_,r(l).device_id),u(m,L),u(k,`Retry #${r(l).retry_count??""}`)},[()=>Be(r(l).preset)]),x(c,i)}),e(n),x(s,n)};N(jt,s=>{y.pendingActions.length===0?s(Tt):s(Lt,!1)})}e(Ze),e(xe),$((s,n,c)=>{u(gt,s),Se.disabled=n,pe(Se,1,`px-5 py-2.5 rounded-lg font-semibold uppercase tracking-wider transition-all w-full sm:w-auto
                 ${c??""}`,"svelte-92554t"),u(yt,y.schedules.length),u(St,y.pendingActions.length)},[()=>Object.keys(r(q)).length,()=>r(w)||!r(K).trim(),()=>!r(w)&&r(K).trim()?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary"]),B(Pe,()=>r(K),s=>o(K,s)),Mt(ie,()=>r(ue),s=>o(ue,s)),B(Ie,()=>r(ge),s=>o(ge,s)),x(et,xe),Et()}Nt(["click"]);export{Dr as component};
