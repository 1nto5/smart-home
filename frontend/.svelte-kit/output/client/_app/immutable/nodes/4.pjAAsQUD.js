import{d as Bt,f as x,a as g,s as v}from"../chunks/C6IfJnDo.js";import{p as Kt,s as f,c as Rt,d as Et,g as o,j as a,k as r,t as A,l as Ft,e as It,m as t,$ as Mt,n as e,o as Z,v as Ge,w as Je,f as Be}from"../chunks/DKHSd8_d.js";import{i as R}from"../chunks/DTZz9ds9.js";import{e as pe,b as Zt,c as Ht,a as y,d as ue,g as Xt,r as $,f as qt,h as zt,i as Gt,u as Jt,t as Qt,j as Ut,k as Vt}from"../chunks/C61pVXLe.js";import{c as Wt}from"../chunks/YQ5o6Efk.js";import{h as Yt,b as E,X as er,a as Qe,P as tr}from"../chunks/DbpimVpx.js";import{b as rr}from"../chunks/D1qDfmfk.js";import{L as Ue,Z as sr,M as ar,S as nr}from"../chunks/BES3RAfQ.js";import{P as Ve,C as We,a as or,T as Ye}from"../chunks/BIYMGcwI.js";import{P as et}from"../chunks/IJt0bsz6.js";var lr=x('<div class="card card-active glow-lights mb-4"><div class="p-4 space-y-4"><div class="flex flex-col sm:flex-row gap-3"><input type="text" placeholder="Preset ID (e.g. reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/> <input type="text" placeholder="Display name (e.g. Reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/></div> <div class="flex flex-wrap items-center gap-4"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-10 h-6 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-1 left-1 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-content-primary text-sm">Power On</span></label> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Brightness</span> <input type="range" min="1" max="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-12"> </span></div> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Color</span> <input type="range" min="2700" max="6500" step="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-16"> </span></div></div> <div class="flex gap-2"><button class="px-4 py-2.5 rounded-lg glow-lights power-btn-on font-semibold uppercase tracking-wider disabled:opacity-50 transition-all">Create Preset</button> <button class="px-3 py-2.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary hover:border-stroke-strong transition-colors"><!></button></div></div></div>'),ir=x('<div class="space-y-3 pt-2 border-t border-stroke-subtle"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-9 h-5 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-sm text-content-primary">Power</span></label> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Brightness</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="1" max="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Color Temp</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="2700" max="6500" step="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="flex gap-2 pt-1"><button class="flex-1 py-2 rounded-lg bg-success/20 text-success border border-success/30 font-medium text-sm disabled:opacity-50 hover:bg-success/30 transition-colors">Save</button> <button class="px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Cancel</button></div></div>'),cr=x('<span class="font-display"> </span> <span class="text-content-tertiary">/</span> <span class="font-display"> </span>',1),dr=x("<!> <span>Off</span>",1),vr=x('<button class="text-sm text-content-secondary hover:text-device-lights-text transition-colors flex items-center gap-2"><!></button>'),pr=x('<div class="card group hover:border-device-lights-text/30 transition-colors"><div class="p-4"><div class="flex items-center justify-between mb-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-lg glow-lights power-btn-on flex items-center justify-center"><!></div> <span class="font-display text-sm uppercase tracking-wider text-content-primary"> </span></div> <div class="flex items-center gap-1.5"><button title="Apply to all lamps"><!></button> <button class="p-2 rounded-lg bg-surface-recessed border border-stroke-default text-content-tertiary opacity-0 group-hover:opacity-100 hover:bg-error/10 hover:text-error hover:border-error/30 transition-all" title="Delete preset"><!></button></div></div> <!></div></div>'),ur=x('<span class="mx-1 text-content-tertiary">/</span> <span class="text-warning"> </span>',1),gr=x('<div class="mt-3 px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-subtle inline-flex items-center gap-2"><!> <span class="text-sm text-content-secondary"><span class="text-success"> </span> <!></span></div>'),fr=x('<option class="svelte-92554t"> </option>'),xr=x('<div class="card p-6 text-center"><!> <p class="text-content-tertiary">No schedules configured</p></div>'),br=x('<div><div class="flex items-center gap-4"><div class="font-display text-2xl text-accent neon-text-subtle"> </div> <div class="h-8 w-px bg-stroke-subtle"></div> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-tertiary ml-2"><span class="text-device-lights-text"> </span></span></div></div> <div class="flex gap-2"><button> </button> <button class="p-1.5 rounded-lg bg-error/10 text-error border border-error/30 hover:bg-error/20 transition-colors"><!></button></div></div>'),_r=x('<div class="space-y-2"></div>'),mr=x('<button class="ml-3 px-3 py-1.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Clear All</button>'),hr=x('<div class="card p-4 flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-success animate-glow"></div> <p class="text-content-secondary text-sm">All lamps online - no pending actions</p></div>'),yr=x('<div class="card p-3 flex items-center justify-between border-warning/30"><div class="flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-warning animate-glow"></div> <span class="font-mono text-sm text-content-primary"> </span> <span class="text-content-tertiary">â†’</span> <span class="text-sm text-device-lights-text"> </span></div> <span class="text-xs font-display text-content-tertiary px-2 py-1 rounded bg-surface-recessed"> </span></div>'),wr=x('<div class="space-y-2"></div>'),kr=x('<div class="space-y-8 pb-24"><section><div class="section-header section-header-lights svelte-92554t"><div class="section-icon glow-lights svelte-92554t"><!></div> <h2 class="section-title svelte-92554t">Lamp Presets</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t"></div> <button class="ml-3 px-3 py-1.5 rounded-lg glow-lights power-btn-on text-sm font-medium flex items-center gap-1.5 transition-transform hover:scale-105"><!> Add</button></div> <!> <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Create Schedule</h2> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <div class="card p-4"><div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary focus:border-accent focus:outline-none transition-colors"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary flex-1 sm:flex-initial focus:border-accent focus:outline-none transition-colors svelte-92554t"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary font-display focus:border-accent focus:outline-none transition-colors"/></div> <button style="--color-accent-glow: var(--color-accent-glow);">Add</button></div></div></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Schedules</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-warning) 15%, transparent); border-color: color-mix(in srgb, var(--color-warning) 30%, transparent); color: var(--color-warning);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-warning);">Pending Actions</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-warning) 40%, transparent) 0%, transparent 100%);"></div> <!></div> <!></section></div>');function Nr(tt,rt){Kt(rt,!0);let G=f(Rt({})),ae=f(null),H=f(null),F=f(""),ge=f("night"),fe=f("19:00"),w=f(!1),ne=f(null),J=f(100),Q=f(4e3),oe=f(!0),U=f(!1),X=f(""),q=f(""),V=f(100),W=f(4e3),le=f(!0);async function ie(){o(G,await Xt(),!0)}Et(()=>{rr&&ie()});function st(s){switch(s){case"day":return nr;case"night":return ar;case"off":return et;default:return Ue}}async function at(s){o(ae,s,!0),o(H,null);try{o(H,await zt(s),!0),y.refreshPending()}catch(n){console.error(n)}o(ae,null)}function nt(s,n){o(ne,s,!0),o(J,n.brightness,!0),o(Q,n.colorTemp,!0),o(oe,n.power,!0)}async function ot(s){o(w,!0);try{await Jt(s,r(J),r(Q),r(oe)),o(ne,null),await ie()}catch(n){console.error(n)}o(w,!1)}function lt(){o(ne,null)}async function it(){if(!(!r(X).trim()||!r(q).trim())){o(w,!0);try{const s=r(X).trim().toLowerCase().replace(/\s+/g,"-");await qt(s,r(q).trim(),r(V),r(W),r(le)),o(X,""),o(q,""),o(V,100),o(W,4e3),o(le,!0),o(U,!1),await ie()}catch(s){console.error(s),alert(s.message||"Failed to create preset")}o(w,!1)}}async function ct(s){if(confirm(`Delete preset "${s}"? This will also delete any schedules using this preset.`)){o(w,!0);try{await Gt(s),await ie(),await y.refreshSchedules()}catch(n){console.error(n)}o(w,!1)}}async function dt(){if(r(F).trim()){o(w,!0);try{await Ht(r(F).trim(),r(ge),r(fe)),o(F,""),await y.refreshSchedules()}catch(s){console.error(s)}o(w,!1)}}async function vt(s){await Ut(s),await y.refreshSchedules()}async function pt(s){await Qt(s),await y.refreshSchedules()}async function ut(){await Vt(),await y.refreshPending()}function Ke(s){const n=r(G)[s];return(n==null?void 0:n.name)??s}var xe=kr();Yt("92554t",s=>{It(()=>{Mt.title="Smart Home - Lighting"})});var be=t(xe),_e=t(be),me=t(_e),gt=t(me);Ue(gt,{class:"w-4 h-4"}),e(me);var he=a(me,4),ft=t(he,!0);e(he);var ye=a(he,4);ye.__click=()=>o(U,!r(U));var xt=t(ye);Ve(xt,{class:"w-4 h-4"}),Z(),e(ye),e(_e);var Re=a(_e,2);{var bt=s=>{var n=lr(),c=t(n),l=t(c),i=t(l);$(i);var d=a(i,2);$(d),e(l);var p=a(l,2),u=t(p),b=t(u);$(b),Z(4),e(u);var _=a(u,2),m=a(t(_),2);$(m);var P=a(m,2),L=t(P);e(P),e(_);var O=a(_,2),k=a(t(O),2);$(k);var D=a(k,2),j=t(D);e(D),e(O),e(p);var N=a(p,2),T=t(N);T.__click=it;var I=a(T,2);I.__click=()=>o(U,!1);var Y=t(I);er(Y,{class:"w-5 h-5"}),e(I),e(N),e(c),e(n),A(h=>{v(L,`${r(V)??""}%`),v(j,`${r(W)??""}K`),T.disabled=h},[()=>r(w)||!r(X).trim()||!r(q).trim()]),E(i,()=>r(X),h=>o(X,h)),E(d,()=>r(q),h=>o(q,h)),Qe(b,()=>r(le),h=>o(le,h)),E(m,()=>r(V),h=>o(V,h)),E(k,()=>r(W),h=>o(W,h)),g(s,n)};R(Re,s=>{r(U)&&s(bt)})}var we=a(Re,2);pe(we,21,()=>Object.entries(r(G)),([s,n])=>s,(s,n)=>{var c=Ge(()=>Je(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=pr(),p=t(d),u=t(p),b=t(u),_=t(b),m=t(_);Wt(m,()=>st(l()),(B,C)=>{C(B,{class:"w-4 h-4"})}),e(_);var P=a(_,2),L=t(P,!0);e(P),e(b);var O=a(b,2),k=t(O);k.__click=()=>at(l());let D;var j=t(k);tr(j,{class:"w-4 h-4"}),e(k);var N=a(k,2);N.__click=()=>ct(l());var T=t(N);Ye(T,{class:"w-4 h-4"}),e(N),e(O),e(u);var I=a(u,2);{var Y=B=>{var C=ir(),ee=t(C),de=t(ee);$(de),Z(4),e(ee);var te=a(ee,2),S=t(te),K=a(t(S),2),M=t(K);e(K),e(S);var ve=a(S,2);$(ve),e(te);var z=a(te,2),re=t(z),Xe=a(t(re),2),Dt=t(Xe);e(Xe),e(re);var qe=a(re,2);$(qe),e(z);var ze=a(z,2),Ne=t(ze);Ne.__click=()=>ot(l());var Nt=a(Ne,2);Nt.__click=lt,e(ze),e(C),A(()=>{v(M,`${r(J)??""}%`),v(Dt,`${r(Q)??""}K`),Ne.disabled=r(w)}),Qe(de,()=>r(oe),se=>o(oe,se)),E(ve,()=>r(J),se=>o(J,se)),E(qe,()=>r(Q),se=>o(Q,se)),g(B,C)},h=B=>{var C=vr();C.__click=()=>nt(l(),i());var ee=t(C);{var de=S=>{var K=cr(),M=Be(K),ve=t(M);e(M);var z=a(M,4),re=t(z);e(z),A(()=>{v(ve,`${i().brightness??""}%`),v(re,`${i().colorTemp??""}K`)}),g(S,K)},te=S=>{var K=dr(),M=Be(K);et(M,{class:"w-4 h-4 text-content-tertiary"}),Z(2),g(S,K)};R(ee,S=>{i().power?S(de):S(te,!1)})}e(C),g(B,C)};R(I,B=>{r(ne)===l()?B(Y):B(h,!1)})}e(p),e(d),A(()=>{v(L,i().name),k.disabled=r(ae)!==null,D=ue(k,1,"p-2 rounded-lg bg-surface-recessed border border-stroke-default text-device-lights-text hover:glow-lights hover:power-btn-on transition-all disabled:opacity-50",null,D,{"pulse-ring":r(ae)===l()})}),g(s,d)}),e(we);var _t=a(we,2);{var mt=s=>{var n=gr(),c=t(n);sr(c,{class:"w-4 h-4 text-device-lights-text"});var l=a(c,2),i=t(l),d=t(i);e(i);var p=a(i,2);{var u=b=>{var _=ur(),m=a(Be(_),2),P=t(m);e(m),A(()=>v(P,`${r(H).pending.length??""} pending`)),g(b,_)};R(p,b=>{r(H).pending.length>0&&b(u)})}e(l),e(n),A(()=>v(d,`${r(H).success.length??""} ok`)),g(s,n)};R(_t,s=>{r(H)&&s(mt)})}e(be);var ke=a(be,2),Pe=t(ke),Ee=t(Pe),ht=t(Ee);Ve(ht,{class:"w-4 h-4"}),e(Ee),Z(4),e(Pe);var Fe=a(Pe,2),Ie=t(Fe),Ce=t(Ie);$(Ce);var Se=a(Ce,2),ce=t(Se);pe(ce,21,()=>Object.entries(r(G)),([s,n])=>s,(s,n)=>{var c=Ge(()=>Je(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=fr(),p=t(d,!0);e(d);var u={};A(()=>{v(p,i().name),u!==(u=l())&&(d.value=(d.__value=l())??"")}),g(s,d)}),e(ce);var Me=a(ce,2);$(Me),e(Se);var Ae=a(Se,2);Ae.__click=dt,e(Ie),e(Fe),e(ke);var $e=a(ke,2),je=t($e),Te=t(je),yt=t(Te);We(yt,{class:"w-4 h-4"}),e(Te);var Ze=a(Te,4),wt=t(Ze,!0);e(Ze),Z(2),e(je);var kt=a(je,2);{var Pt=s=>{var n=xr(),c=t(n);We(c,{class:"w-10 h-10 mx-auto text-content-tertiary mb-2 opacity-50"}),Z(2),e(n),g(s,n)},Ct=s=>{var n=_r();pe(n,21,()=>y.schedules,c=>c.id,(c,l)=>{var i=br();let d;var p=t(i),u=t(p),b=t(u,!0);e(u);var _=a(u,4),m=t(_),P=t(m,!0);e(m);var L=a(m,2),O=t(L),k=t(O,!0);e(O),e(L),e(_),e(p);var D=a(p,2),j=t(D);j.__click=()=>pt(r(l).id);var N=t(j,!0);e(j);var T=a(j,2);T.__click=()=>vt(r(l).id);var I=t(T);Ye(I,{class:"w-4 h-4"}),e(T),e(D),e(i),A(Y=>{d=ue(i,1,"card p-3 flex items-center justify-between transition-opacity svelte-92554t",null,d,{"opacity-50":!r(l).enabled,"card-active":r(l).enabled,"glow-accent":r(l).enabled}),v(b,r(l).time),v(P,r(l).name),v(k,Y),ue(j,1,`px-3 py-1.5 rounded-lg font-medium text-sm transition-all
                       ${r(l).enabled?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary hover:border-stroke-strong"}`,"svelte-92554t"),v(N,r(l).enabled?"On":"Off")},[()=>Ke(r(l).preset)]),g(c,i)}),e(n),g(s,n)};R(kt,s=>{y.schedules.length===0?s(Pt):s(Ct,!1)})}e($e);var He=a($e,2),Le=t(He),Oe=t(Le),St=t(Oe);or(St,{class:"w-4 h-4"}),e(Oe);var De=a(Oe,4),At=t(De,!0);e(De);var $t=a(De,4);{var jt=s=>{var n=mr();n.__click=ut,g(s,n)};R($t,s=>{y.pendingActions.length>0&&s(jt)})}e(Le);var Tt=a(Le,2);{var Lt=s=>{var n=hr();g(s,n)},Ot=s=>{var n=wr();pe(n,21,()=>y.pendingActions,c=>c.id,(c,l)=>{var i=yr(),d=t(i),p=a(t(d),2),u=t(p,!0);e(p);var b=a(p,4),_=t(b,!0);e(b),e(d);var m=a(d,2),P=t(m);e(m),e(i),A(L=>{v(u,r(l).device_id),v(_,L),v(P,`Retry #${r(l).retry_count??""}`)},[()=>Ke(r(l).preset)]),g(c,i)}),e(n),g(s,n)};R(Tt,s=>{y.pendingActions.length===0?s(Lt):s(Ot,!1)})}e(He),e(xe),A((s,n,c)=>{v(ft,s),Ae.disabled=n,ue(Ae,1,`px-5 py-2.5 rounded-lg font-semibold uppercase tracking-wider transition-all w-full sm:w-auto
                 ${c??""}`,"svelte-92554t"),v(wt,y.schedules.length),v(At,y.pendingActions.length)},[()=>Object.keys(r(G)).length,()=>r(w)||!r(F).trim(),()=>!r(w)&&r(F).trim()?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary"]),E(Ce,()=>r(F),s=>o(F,s)),Zt(ce,()=>r(ge),s=>o(ge,s)),E(Me,()=>r(fe),s=>o(fe,s)),g(tt,xe),Ft()}Bt(["click"]);export{Nr as component};
