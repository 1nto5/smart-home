import{d as Te,f as _,a as m,s as v}from"../chunks/CjotZmkh.js";import{p as Ne,s as w,a as Me,b as Re,c as n,t as P,g as r,d as De,h as f,e as He,i as a,$ as Ie,n as ae,j as t,k as re,l as se}from"../chunks/D-6XIZR8.js";import{i as L}from"../chunks/BrodxcLD.js";import{e as O,b as Ke,g as qe,c as ze,a as u,r as ne,d as oe,f as Be,t as Ee,h as Fe,i as Ge}from"../chunks/C8iX40Sw.js";import{c as Je}from"../chunks/ks5tSOE-.js";import{h as Qe,b as le,P as Ue}from"../chunks/C_vgePYj.js";import{b as Ve}from"../chunks/BvlVR2yQ.js";import{L as ie,M as We,S as Xe}from"../chunks/CcuWYFwD.js";import{P as Ye,C as Ze,T as et}from"../chunks/GEVdppSg.js";import{P as tt}from"../chunks/CoCeDZ5W.js";var at=_('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-4"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><!> <span class="font-medium text-content-primary"> </span></div> <button class="p-1.5 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors disabled:opacity-50" title="Apply to all lamps"><!></button></div> <p class="text-sm text-content-secondary"> </p></div>'),rt=_('<p class="text-sm mt-3 text-content-secondary"> </p>'),st=_("<option> </option>"),nt=_('<p class="text-content-secondary">No schedules yet</p>'),ot=_('<div><div class="flex items-center gap-4"><span class="text-xl font-mono text-content-primary"> </span> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded-lg bg-error/20 text-error hover:bg-error/30 font-medium transition-colors"><!></button></div></div>'),lt=_('<div class="space-y-2"></div>'),it=_('<button class="text-sm px-3 py-1 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors">Clear All</button>'),ct=_('<p class="text-content-secondary">No pending actions (all lamps online)</p>'),dt=_('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between"><div><span class="font-mono text-sm text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div> <span class="text-xs text-content-tertiary"> </span></div>'),vt=_('<div class="space-y-2"></div>'),pt=_('<div class="space-y-8"><section><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> Lamp Presets</h2> <div class="grid grid-cols-2 sm:grid-cols-4 gap-3"></div> <!></section> <section class="bg-surface-elevated border border-stroke-default rounded-xl p-4"><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> Create Schedule</h2> <div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary flex-1 sm:flex-initial"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary"/></div> <button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium w-full sm:w-auto">Add</button></div></section> <section><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary"> </h2> <!></div> <!></section></div>');function kt(ce,de){Ne(de,!0);let T=w(Me({})),N=w(null),$=w(null),k=w(""),M=w("night"),R=w("19:00"),D=w(!1);Re(()=>{Ve&&qe().then(e=>f(T,e,!0))});function ve(e){switch(e){case"day":return Xe;case"night":return We;case"off":return tt;default:return ie}}async function pe(e){f(N,e,!0),f($,null);try{f($,await Be(e),!0),u.refreshPending()}catch(s){console.error(s)}f(N,null)}async function ue(){if(r(k).trim()){f(D,!0);try{await ze(r(k).trim(),r(M),r(R)),f(k,""),await u.refreshSchedules()}catch(e){console.error(e)}f(D,!1)}}async function me(e){await Fe(e),await u.refreshSchedules()}async function fe(e){await Ee(e),await u.refreshSchedules()}async function _e(){await Ge(),await u.refreshPending()}var H=pt();Qe("92554t",e=>{He(()=>{Ie.title="Smart Home - Lighting"})});var I=a(H),K=a(I),xe=a(K);ie(xe,{class:"w-5 h-5"}),ae(),t(K);var q=n(K,2);O(q,21,()=>Object.entries(r(T)),([e,s])=>e,(e,s)=>{var i=re(()=>se(r(s),2));let o=()=>r(i)[0],c=()=>r(i)[1];var l=at(),d=a(l),p=a(d),b=a(p);Je(b,()=>ve(o()),(y,V)=>{V(y,{class:"w-5 h-5 text-accent"})});var h=n(b,2),x=a(h,!0);t(h),t(p);var g=n(p,2);g.__click=()=>pe(o());var A=a(g);Ue(A,{class:"w-4 h-4"}),t(g),t(d);var j=n(d,2),C=a(j,!0);t(j),t(l),P(()=>{v(x,c().name),g.disabled=r(N)!==null,v(C,c().power?`${c().brightness}% / ${c().colorTemp}K`:"Off")}),m(e,l)}),t(q);var ge=n(q,2);{var be=e=>{var s=rt(),i=a(s);t(s),P(()=>v(i,`Last apply: ${r($).success.length??""} ok, ${r($).pending.length??""} pending`)),m(e,s)};L(ge,e=>{r($)&&e(be)})}t(I);var z=n(I,2),B=a(z),he=a(B);Ye(he,{class:"w-5 h-5"}),ae(),t(B);var X=n(B,2),E=a(X);ne(E);var F=n(E,2),S=a(F);O(S,21,()=>Object.entries(r(T)),([e,s])=>e,(e,s)=>{var i=re(()=>se(r(s),2));let o=()=>r(i)[0],c=()=>r(i)[1];var l=st(),d=a(l,!0);t(l);var p={};P(()=>{v(d,c().name),p!==(p=o())&&(l.value=(l.__value=o())??"")}),m(e,l)}),t(S);var Y=n(S,2);ne(Y),t(F);var Z=n(F,2);Z.__click=ue,t(X),t(z);var G=n(z,2),J=a(G),ee=a(J);Ze(ee,{class:"w-5 h-5"});var ye=n(ee);t(J);var we=n(J,2);{var ke=e=>{var s=nt();m(e,s)},Pe=e=>{var s=lt();O(s,21,()=>u.schedules,i=>i.id,(i,o)=>{var c=ot();let l;var d=a(c),p=a(d),b=a(p,!0);t(p);var h=n(p,2),x=a(h),g=a(x,!0);t(x);var A=n(x,2),j=a(A);t(A),t(h),t(d);var C=n(d,2),y=a(C);y.__click=()=>fe(r(o).id);var V=a(y,!0);t(y);var W=n(y,2);W.__click=()=>me(r(o).id);var Oe=a(W);et(Oe,{class:"w-4 h-4"}),t(W),t(C),t(c),P(()=>{l=oe(c,1,"bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between",null,l,{"opacity-50":!r(o).enabled}),v(b,r(o).time),v(g,r(o).name),v(j,`(${r(o).preset??""})`),oe(y,1,`text-sm px-3 py-1 rounded-lg font-medium transition-colors
                       ${r(o).enabled?"bg-success/20 text-success":"bg-surface-recessed text-content-secondary"}`),v(V,r(o).enabled?"On":"Off")}),m(i,c)}),t(s),m(e,s)};L(we,e=>{u.schedules.length===0?e(ke):e(Pe,!1)})}t(G);var te=n(G,2),Q=a(te),U=a(Q),$e=a(U);t(U);var Se=n(U,2);{var Ae=e=>{var s=it();s.__click=_e,m(e,s)};L(Se,e=>{u.pendingActions.length>0&&e(Ae)})}t(Q);var je=n(Q,2);{var Ce=e=>{var s=ct();m(e,s)},Le=e=>{var s=vt();O(s,21,()=>u.pendingActions,i=>i.id,(i,o)=>{var c=dt(),l=a(c),d=a(l),p=a(d,!0);t(d);var b=n(d,2),h=a(b);t(b),t(l);var x=n(l,2),g=a(x);t(x),t(c),P(()=>{v(p,r(o).device_id),v(h,`â†’ ${r(o).preset??""}`),v(g,`Retry #${r(o).retry_count??""}`)}),m(i,c)}),t(s),m(e,s)};L(je,e=>{u.pendingActions.length===0?e(Ce):e(Le,!1)})}t(te),t(H),P(e=>{Z.disabled=e,v(ye,` Schedules (${u.schedules.length??""})`),v($e,`Pending Actions (${u.pendingActions.length??""})`)},[()=>r(D)||!r(k).trim()]),le(E,()=>r(k),e=>f(k,e)),Ke(S,()=>r(M),e=>f(M,e)),le(Y,()=>r(R),e=>f(R,e)),m(ce,H),De()}Te(["click"]);export{kt as component};
