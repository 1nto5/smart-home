import{d as Bt,f as b,a as f,s as v}from"../chunks/C6IfJnDo.js";import{p as Kt,s as x,c as Rt,d as Et,g as o,j as a,k as r,t as A,l as Ft,e as It,m as t,$ as Mt,n as e,o as M,v as Ge,w as Je,f as Be}from"../chunks/DKHSd8_d.js";import{i as N}from"../chunks/DTZz9ds9.js";import{e as ve,b as Zt,c as Ht,a as w,d as pe,g as Xt,r as $,f as qt,h as zt,i as Gt,u as Jt,t as Qt,j as Ut,k as Vt}from"../chunks/Dc1DVRgn.js";import{c as Wt}from"../chunks/YQ5o6Efk.js";import{h as Yt,b as B,X as er,a as Qe,P as tr}from"../chunks/MqMbLj5U.js";import{b as rr}from"../chunks/D1qDfmfk.js";import{L as Ue,Z as sr,M as ar,S as nr}from"../chunks/BPCsJ9ce.js";import{P as Ve,C as We,a as or,T as Ye}from"../chunks/GI-K3CKk.js";import{P as et}from"../chunks/2m6lEa8O.js";var lr=b('<div class="card card-active glow-lights mb-4"><div class="p-4 space-y-4"><div class="flex flex-col sm:flex-row gap-3"><input type="text" placeholder="Preset ID (e.g. reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/> <input type="text" placeholder="Display name (e.g. Reading)" class="flex-1 bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary placeholder:text-content-tertiary focus:border-device-lights-text focus:outline-none transition-colors"/></div> <div class="flex flex-wrap items-center gap-4"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-10 h-6 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-1 left-1 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-content-primary text-sm">Power On</span></label> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Brightness</span> <input type="range" min="1" max="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-12"> </span></div> <div class="flex items-center gap-2"><span class="text-content-tertiary text-xs uppercase tracking-wider">Color</span> <input type="range" min="2700" max="6500" step="100" class="w-24" style="--color-accent: var(--color-lights-text);"/> <span class="font-display text-device-lights-text w-16"> </span></div></div> <div class="flex gap-2"><button class="px-4 py-2.5 rounded-lg glow-lights power-btn-on font-semibold uppercase tracking-wider disabled:opacity-50 transition-all">Create Preset</button> <button class="px-3 py-2.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary hover:border-stroke-strong transition-colors"><!></button></div></div></div>'),ir=b('<div class="space-y-3 pt-2 border-t border-stroke-subtle"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" class="sr-only peer"/> <div class="w-9 h-5 rounded-full bg-surface-recessed border border-stroke-default peer-checked:glow-lights peer-checked:power-btn-on transition-all relative"><div class="absolute top-0.5 left-0.5 w-4 h-4 rounded-full bg-content-tertiary peer-checked:translate-x-4 peer-checked:bg-white transition-all"></div></div> <span class="text-sm text-content-primary">Power</span></label> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Brightness</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="1" max="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="space-y-1"><div class="flex items-center justify-between"><span class="text-xs text-content-tertiary">Color Temp</span> <span class="font-display text-sm text-device-lights-text"> </span></div> <input type="range" min="2700" max="6500" step="100" class="w-full" style="--color-accent: var(--color-lights-text);"/></div> <div class="flex gap-2 pt-1"><button class="flex-1 py-2 rounded-lg bg-success/20 text-success border border-success/30 font-medium text-sm disabled:opacity-50 hover:bg-success/30 transition-colors">Save</button> <button class="px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Cancel</button></div></div>'),cr=b('<span class="font-display"> </span> <span class="text-content-tertiary">/</span> <span class="font-display"> </span>',1),dr=b("<!> <span>Off</span>",1),vr=b('<button class="text-sm text-content-secondary hover:text-device-lights-text transition-colors flex items-center gap-2"><!></button>'),pr=b('<div class="card group hover:border-device-lights-text/30 transition-colors"><div class="p-4"><div class="flex items-center justify-between mb-3"><div class="flex items-center gap-2"><div class="w-8 h-8 rounded-lg glow-lights power-btn-on flex items-center justify-center"><!></div> <span class="font-display text-sm uppercase tracking-wider text-content-primary"> </span></div> <div class="flex items-center gap-1.5"><button title="Apply to all lamps"><!></button> <button class="p-2 rounded-lg bg-surface-recessed border border-stroke-default text-content-tertiary hover:bg-error/10 hover:text-error hover:border-error/30 transition-all" title="Delete preset"><!></button></div></div> <!></div></div>'),ur=b('<span class="mx-1 text-content-tertiary">/</span> <span class="text-warning"> </span>',1),gr=b('<div class="mt-3 px-3 py-2 rounded-lg bg-surface-recessed border border-stroke-subtle inline-flex items-center gap-2"><!> <span class="text-sm text-content-secondary"><span class="text-success"> </span> <!></span></div>'),fr=b('<option class="svelte-92554t"> </option>'),xr=b('<div class="card p-6 text-center"><!> <p class="text-content-tertiary">No schedules configured</p></div>'),br=b('<div><div class="flex items-center justify-between mb-2"><div class="font-display text-xl text-accent neon-text-subtle"> </div> <div class="flex gap-1.5"><button> </button> <button class="p-1.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-tertiary hover:bg-error/10 hover:text-error hover:border-error/30 transition-colors"><!></button></div></div> <div class="text-sm"><span class="font-medium text-content-primary"> </span> <span class="text-content-tertiary mx-1">→</span> <span class="text-device-lights-text"> </span></div></div>'),_r=b('<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3"></div>'),mr=b('<button class="ml-3 px-3 py-1.5 rounded-lg bg-surface-recessed border border-stroke-default text-content-secondary text-sm hover:border-stroke-strong transition-colors">Clear All</button>'),hr=b('<div class="card p-4 flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-success animate-glow"></div> <p class="text-content-secondary text-sm">All lamps online - no pending actions</p></div>'),yr=b('<div class="card p-3 flex items-center justify-between border-warning/30"><div class="flex items-center gap-3"><div class="w-2 h-2 rounded-full bg-warning animate-glow"></div> <span class="font-mono text-sm text-content-primary"> </span> <span class="text-content-tertiary">→</span> <span class="text-sm text-device-lights-text"> </span></div> <span class="text-xs font-display text-content-tertiary px-2 py-1 rounded bg-surface-recessed"> </span></div>'),wr=b('<div class="space-y-2"></div>'),kr=b('<div class="space-y-8 pb-24"><section><div class="section-header section-header-lights svelte-92554t"><div class="section-icon glow-lights svelte-92554t"><!></div> <h2 class="section-title svelte-92554t">Lamp Presets</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t"></div> <button class="ml-3 px-3 py-1.5 rounded-lg glow-lights power-btn-on text-sm font-medium flex items-center gap-1.5 transition-transform hover:scale-105"><!> Add</button></div> <!> <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-3"></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Create Schedule</h2> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <div class="card p-4"><div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary focus:border-accent focus:outline-none transition-colors"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary flex-1 sm:flex-initial focus:border-accent focus:outline-none transition-colors svelte-92554t"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2.5 text-content-primary font-display focus:border-accent focus:outline-none transition-colors"/></div> <button style="--color-accent-glow: var(--color-accent-glow);">Add</button></div></div></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-accent) 15%, transparent); border-color: color-mix(in srgb, var(--color-accent) 30%, transparent); color: var(--color-accent);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-accent);">Schedules</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-accent) 40%, transparent) 0%, transparent 100%);"></div></div> <!></section> <section><div class="section-header svelte-92554t"><div class="section-icon svelte-92554t" style="background: color-mix(in srgb, var(--color-warning) 15%, transparent); border-color: color-mix(in srgb, var(--color-warning) 30%, transparent); color: var(--color-warning);"><!></div> <h2 class="section-title svelte-92554t" style="color: var(--color-warning);">Pending Actions</h2> <span class="section-count svelte-92554t"> </span> <div class="section-line svelte-92554t" style="background: linear-gradient(90deg, color-mix(in srgb, var(--color-warning) 40%, transparent) 0%, transparent 100%);"></div> <!></div> <!></section></div>');function Nr(tt,rt){Kt(rt,!0);let z=x(Rt({})),se=x(null),Z=x(null),K=x(""),ue=x("night"),ge=x("19:00"),k=x(!1),ae=x(null),G=x(100),J=x(4e3),ne=x(!0),Q=x(!1),H=x(""),X=x(""),U=x(100),V=x(4e3),oe=x(!0);async function le(){o(z,await Xt(),!0)}Et(()=>{rr&&le()});function st(s){switch(s){case"day":return nr;case"night":return ar;case"off":return et;default:return Ue}}async function at(s){o(se,s,!0),o(Z,null);try{o(Z,await zt(s),!0),w.refreshPending()}catch(n){console.error(n)}o(se,null)}function nt(s,n){o(ae,s,!0),o(G,n.brightness,!0),o(J,n.colorTemp,!0),o(ne,n.power,!0)}async function ot(s){o(k,!0);try{await Jt(s,r(G),r(J),r(ne)),o(ae,null),await le()}catch(n){console.error(n)}o(k,!1)}function lt(){o(ae,null)}async function it(){if(!(!r(H).trim()||!r(X).trim())){o(k,!0);try{const s=r(H).trim().toLowerCase().replace(/\s+/g,"-");await qt(s,r(X).trim(),r(U),r(V),r(oe)),o(H,""),o(X,""),o(U,100),o(V,4e3),o(oe,!0),o(Q,!1),await le()}catch(s){console.error(s),alert(s.message||"Failed to create preset")}o(k,!1)}}async function ct(s){if(confirm(`Delete preset "${s}"? This will also delete any schedules using this preset.`)){o(k,!0);try{await Gt(s),await le(),await w.refreshSchedules()}catch(n){console.error(n)}o(k,!1)}}async function dt(){if(r(K).trim()){o(k,!0);try{await Ht(r(K).trim(),r(ue),r(ge)),o(K,""),await w.refreshSchedules()}catch(s){console.error(s)}o(k,!1)}}async function vt(s){await Ut(s),await w.refreshSchedules()}async function pt(s){await Qt(s),await w.refreshSchedules()}async function ut(){await Vt(),await w.refreshPending()}function Ke(s){const n=r(z)[s];return(n==null?void 0:n.name)??s}var fe=kr();Yt("92554t",s=>{It(()=>{Mt.title="Smart Home - Lighting"})});var xe=t(fe),be=t(xe),_e=t(be),gt=t(_e);Ue(gt,{class:"w-4 h-4"}),e(_e);var me=a(_e,4),ft=t(me,!0);e(me);var he=a(me,4);he.__click=()=>o(Q,!r(Q));var xt=t(he);Ve(xt,{class:"w-4 h-4"}),M(),e(he),e(be);var Re=a(be,2);{var bt=s=>{var n=lr(),c=t(n),l=t(c),i=t(l);$(i);var d=a(i,2);$(d),e(l);var p=a(l,2),u=t(p),_=t(u);$(_),M(4),e(u);var m=a(u,2),g=a(t(m),2);$(g);var P=a(g,2),j=t(P);e(P),e(m);var R=a(m,2),h=a(t(R),2);$(h);var T=a(h,2),W=t(T);e(T),e(R),e(p);var L=a(p,2),E=t(L);E.__click=it;var F=a(E,2);F.__click=()=>o(Q,!1);var De=t(F);er(De,{class:"w-5 h-5"}),e(F),e(L),e(c),e(n),A(y=>{v(j,`${r(U)??""}%`),v(W,`${r(V)??""}K`),E.disabled=y},[()=>r(k)||!r(H).trim()||!r(X).trim()]),B(i,()=>r(H),y=>o(H,y)),B(d,()=>r(X),y=>o(X,y)),Qe(_,()=>r(oe),y=>o(oe,y)),B(g,()=>r(U),y=>o(U,y)),B(h,()=>r(V),y=>o(V,y)),f(s,n)};N(Re,s=>{r(Q)&&s(bt)})}var ye=a(Re,2);ve(ye,21,()=>Object.entries(r(z)),([s,n])=>s,(s,n)=>{var c=Ge(()=>Je(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=pr(),p=t(d),u=t(p),_=t(u),m=t(_),g=t(m);Wt(g,()=>st(l()),(O,C)=>{C(O,{class:"w-4 h-4"})}),e(m);var P=a(m,2),j=t(P,!0);e(P),e(_);var R=a(_,2),h=t(R);h.__click=()=>at(l());let T;var W=t(h);tr(W,{class:"w-4 h-4"}),e(h);var L=a(h,2);L.__click=()=>ct(l());var E=t(L);Ye(E,{class:"w-4 h-4"}),e(L),e(R),e(u);var F=a(u,2);{var De=O=>{var C=ir(),Y=t(C),ce=t(Y);$(ce),M(4),e(Y);var ee=a(Y,2),S=t(ee),D=a(t(S),2),I=t(D);e(D),e(S);var de=a(S,2);$(de),e(ee);var q=a(ee,2),te=t(q),Xe=a(t(te),2),Dt=t(Xe);e(Xe),e(te);var qe=a(te,2);$(qe),e(q);var ze=a(q,2),Ne=t(ze);Ne.__click=()=>ot(l());var Nt=a(Ne,2);Nt.__click=lt,e(ze),e(C),A(()=>{v(I,`${r(G)??""}%`),v(Dt,`${r(J)??""}K`),Ne.disabled=r(k)}),Qe(ce,()=>r(ne),re=>o(ne,re)),B(de,()=>r(G),re=>o(G,re)),B(qe,()=>r(J),re=>o(J,re)),f(O,C)},y=O=>{var C=vr();C.__click=()=>nt(l(),i());var Y=t(C);{var ce=S=>{var D=cr(),I=Be(D),de=t(I);e(I);var q=a(I,4),te=t(q);e(q),A(()=>{v(de,`${i().brightness??""}%`),v(te,`${i().colorTemp??""}K`)}),f(S,D)},ee=S=>{var D=dr(),I=Be(D);et(I,{class:"w-4 h-4 text-content-tertiary"}),M(2),f(S,D)};N(Y,S=>{i().power?S(ce):S(ee,!1)})}e(C),f(O,C)};N(F,O=>{r(ae)===l()?O(De):O(y,!1)})}e(p),e(d),A(()=>{v(j,i().name),h.disabled=r(se)!==null,T=pe(h,1,"p-2 rounded-lg bg-surface-recessed border border-stroke-default text-device-lights-text hover:glow-lights hover:power-btn-on transition-all disabled:opacity-50",null,T,{"pulse-ring":r(se)===l()})}),f(s,d)}),e(ye);var _t=a(ye,2);{var mt=s=>{var n=gr(),c=t(n);sr(c,{class:"w-4 h-4 text-device-lights-text"});var l=a(c,2),i=t(l),d=t(i);e(i);var p=a(i,2);{var u=_=>{var m=ur(),g=a(Be(m),2),P=t(g);e(g),A(()=>v(P,`${r(Z).pending.length??""} pending`)),f(_,m)};N(p,_=>{r(Z).pending.length>0&&_(u)})}e(l),e(n),A(()=>v(d,`${r(Z).success.length??""} ok`)),f(s,n)};N(_t,s=>{r(Z)&&s(mt)})}e(xe);var we=a(xe,2),ke=t(we),Ee=t(ke),ht=t(Ee);Ve(ht,{class:"w-4 h-4"}),e(Ee),M(4),e(ke);var Fe=a(ke,2),Ie=t(Fe),Pe=t(Ie);$(Pe);var Ce=a(Pe,2),ie=t(Ce);ve(ie,21,()=>Object.entries(r(z)),([s,n])=>s,(s,n)=>{var c=Ge(()=>Je(r(n),2));let l=()=>r(c)[0],i=()=>r(c)[1];var d=fr(),p=t(d,!0);e(d);var u={};A(()=>{v(p,i().name),u!==(u=l())&&(d.value=(d.__value=l())??"")}),f(s,d)}),e(ie);var Me=a(ie,2);$(Me),e(Ce);var Se=a(Ce,2);Se.__click=dt,e(Ie),e(Fe),e(we);var Ae=a(we,2),$e=t(Ae),je=t($e),yt=t(je);We(yt,{class:"w-4 h-4"}),e(je);var Ze=a(je,4),wt=t(Ze,!0);e(Ze),M(2),e($e);var kt=a($e,2);{var Pt=s=>{var n=xr(),c=t(n);We(c,{class:"w-10 h-10 mx-auto text-content-tertiary mb-2 opacity-50"}),M(2),e(n),f(s,n)},Ct=s=>{var n=_r();ve(n,21,()=>w.schedules,c=>c.id,(c,l)=>{var i=br();let d;var p=t(i),u=t(p),_=t(u,!0);e(u);var m=a(u,2),g=t(m);g.__click=()=>pt(r(l).id);var P=t(g,!0);e(g);var j=a(g,2);j.__click=()=>vt(r(l).id);var R=t(j);Ye(R,{class:"w-3.5 h-3.5"}),e(j),e(m),e(p);var h=a(p,2),T=t(h),W=t(T,!0);e(T);var L=a(T,4),E=t(L,!0);e(L),e(h),e(i),A(F=>{d=pe(i,1,"card p-3 transition-opacity svelte-92554t",null,d,{"opacity-50":!r(l).enabled,"card-active":r(l).enabled,"glow-accent":r(l).enabled}),v(_,r(l).time),pe(g,1,`px-2.5 py-1 rounded-lg font-medium text-xs transition-all
                         ${r(l).enabled?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary hover:border-stroke-strong"}`,"svelte-92554t"),v(P,r(l).enabled?"On":"Off"),v(W,r(l).name),v(E,F)},[()=>Ke(r(l).preset)]),f(c,i)}),e(n),f(s,n)};N(kt,s=>{w.schedules.length===0?s(Pt):s(Ct,!1)})}e(Ae);var He=a(Ae,2),Te=t(He),Le=t(Te),St=t(Le);or(St,{class:"w-4 h-4"}),e(Le);var Oe=a(Le,4),At=t(Oe,!0);e(Oe);var $t=a(Oe,4);{var jt=s=>{var n=mr();n.__click=ut,f(s,n)};N($t,s=>{w.pendingActions.length>0&&s(jt)})}e(Te);var Tt=a(Te,2);{var Lt=s=>{var n=hr();f(s,n)},Ot=s=>{var n=wr();ve(n,21,()=>w.pendingActions,c=>c.id,(c,l)=>{var i=yr(),d=t(i),p=a(t(d),2),u=t(p,!0);e(p);var _=a(p,4),m=t(_,!0);e(_),e(d);var g=a(d,2),P=t(g);e(g),e(i),A(j=>{v(u,r(l).device_id),v(m,j),v(P,`Retry #${r(l).retry_count??""}`)},[()=>Ke(r(l).preset)]),f(c,i)}),e(n),f(s,n)};N(Tt,s=>{w.pendingActions.length===0?s(Lt):s(Ot,!1)})}e(He),e(fe),A((s,n,c)=>{v(ft,s),Se.disabled=n,pe(Se,1,`px-5 py-2.5 rounded-lg font-semibold uppercase tracking-wider transition-all w-full sm:w-auto
                 ${c??""}`,"svelte-92554t"),v(wt,w.schedules.length),v(At,w.pendingActions.length)},[()=>Object.keys(r(z)).length,()=>r(k)||!r(K).trim(),()=>!r(k)&&r(K).trim()?"glow-accent power-btn-on":"bg-surface-recessed border border-stroke-default text-content-tertiary"]),B(Pe,()=>r(K),s=>o(K,s)),Zt(ie,()=>r(ue),s=>o(ue,s)),B(Me,()=>r(ge),s=>o(ge,s)),f(tt,fe),Ft()}Bt(["click"]);export{Nr as component};
