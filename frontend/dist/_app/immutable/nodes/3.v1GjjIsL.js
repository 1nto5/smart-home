import{c as vt,a as f,d as pt,f as m,s as _}from"../chunks/CEDFY9N9.js";import{f as ut,p as ft,b as mt,d as n,i as s,c as i,s as g,g as r,t as S,h as xt,e as _t,$ as bt,n as A,j as a}from"../chunks/B2drfW2D.js";import{i as T}from"../chunks/Bro-wCEF.js";import{I as gt,s as ht,e as Q,b as yt,a as l,l as Ae,m as wt,d as V,n as Te,r as P,o as Pt,p as kt,q as Ht,v as $t,w as Ot,x as St,y as Ct}from"../chunks/Y5QuyOWE.js";import{h as At,b as N,X as Ne,P as Tt}from"../chunks/hc5Cb2Jx.js";import"../chunks/CDrra-OC.js";import{l as Nt,s as jt}from"../chunks/o9TOya3S.js";import{T as Dt}from"../chunks/4tE47fZ7.js";import{P as je,C as Mt,T as It}from"../chunks/7rqovRcw.js";function Et(W,X){const k=Nt(X,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.562.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */const F=[["circle",{cx:"12",cy:"12",r:"10"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9"}]];gt(W,jt({name:"circle-pause"},()=>k,{get iconNode(){return F},children:(q,v)=>{var C=vt(),j=ut(C);ht(j,X,"default",{}),f(q,C)},$$slots:{default:!0}}))}var Ft=m('<div class="bg-warning/10 border border-warning/30 rounded-lg p-3 mb-4"><p class="text-sm text-warning">Schedules are paused while override is active</p></div>'),qt=m('<div class="flex items-center gap-2"><input type="range" min="5" max="25" step="0.5" class="w-32 accent-accent"/> <span class="text-xl font-mono text-content-primary w-16"> </span></div>'),zt=m('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-4 mb-4"><div class="flex flex-col sm:flex-row gap-3"><input type="text" placeholder="Preset ID (e.g. away)" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary placeholder:text-content-tertiary flex-1"/> <input type="text" placeholder="Display name (e.g. Away)" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary placeholder:text-content-tertiary flex-1"/> <div class="flex items-center gap-2"><input type="number" min="5" max="30" step="0.5" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 w-20 text-content-primary text-center"/> <span class="text-content-secondary">°C</span></div> <button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium">Create</button> <button class="px-3 py-2 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors"><!></button></div></div>'),Lt=m('<div class="flex items-center gap-2"><input type="number" min="5" max="30" step="0.5" class="bg-surface-recessed border border-stroke-default rounded px-2 py-1 w-16 text-content-primary text-center"/> <span class="text-content-secondary">°C</span> <button class="text-xs px-2 py-1 bg-success/20 text-success rounded">Save</button> <button class="text-xs px-2 py-1 bg-surface-recessed text-content-secondary rounded">Cancel</button></div>'),Rt=m('<button class="text-2xl font-mono text-content-primary hover:text-accent transition-colors"> </button>'),Ut=m('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-4 relative group"><button class="absolute top-2 right-2 p-1 rounded bg-error/20 text-error opacity-0 group-hover:opacity-100 transition-opacity" title="Delete preset"><!></button> <div class="flex items-center justify-between mb-2"><span class="font-medium text-content-primary"> </span> <button class="p-1.5 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors disabled:opacity-50" title="Apply to all heaters"><!></button></div> <!></div>'),Xt=m("<option> </option>"),Bt=m('<p class="text-content-secondary">No heater schedules yet</p>'),Gt=m('<div><div class="flex items-center gap-4"><span class="text-xl font-mono text-content-primary"> </span> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded-lg bg-error/20 text-error hover:bg-error/30 font-medium transition-colors"><!></button></div></div>'),Jt=m('<div class="space-y-2"></div>'),Kt=m('<button class="text-sm px-3 py-1 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors">Clear All</button>'),Qt=m('<p class="text-content-secondary">No pending actions (all heaters online)</p>'),Vt=m('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between"><div><span class="font-mono text-sm text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div> <span class="text-xs text-content-tertiary"> </span></div>'),Wt=m('<div class="space-y-2"></div>'),Yt=m('<div class="space-y-8"><section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary flex items-center gap-2"><!> Override Mode</h2> <button> </button></div> <!> <div class="flex flex-col sm:flex-row gap-4"><div class="flex items-center gap-3"><label class="flex items-center gap-2 cursor-pointer"><input type="radio" name="overrideMode" value="pause" class="accent-accent"/> <span class="text-content-primary">Pause schedules</span></label> <label class="flex items-center gap-2 cursor-pointer"><input type="radio" name="overrideMode" value="fixed" class="accent-accent"/> <span class="text-content-primary">Fixed temperature</span></label></div> <!></div></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary flex items-center gap-2"><!> Heater Presets</h2> <button class="text-sm px-3 py-1.5 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors flex items-center gap-1"><!> Add Preset</button></div> <!> <div class="grid grid-cols-2 sm:grid-cols-4 gap-3"></div></section> <section class="bg-surface-elevated border border-stroke-default rounded-xl p-4"><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> Create Schedule</h2> <div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary flex-1 sm:flex-initial"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary"/></div> <button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium w-full sm:w-auto">Add</button></div></section> <section><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary"> </h2> <!></div> <!></section></div>');function cr(W,X){ft(X,!0);let k=g(""),F=g("night"),q=g("22:00"),v=g(!1),C=g(null),j=g(21),H=g("pause"),D=g(18);mt(()=>{l.heaterOverride&&(i(H,l.heaterOverride.mode,!0),i(D,l.heaterOverride.fixed_temp,!0))});async function De(){var t;i(v,!0);const e=!((t=l.heaterOverride)!=null&&t.enabled);try{await Ae(e,r(H),r(D)),await l.refreshHeaterOverride()}catch(o){console.error(o)}i(v,!1)}async function Y(e){var o;if(!((o=l.heaterOverride)!=null&&o.enabled))return;i(v,!0);const t=e??r(H);try{await Ae(!0,t,r(D)),await l.refreshHeaterOverride()}catch(c){console.error(c)}i(v,!1)}async function Me(){if(r(k).trim()){i(v,!0);try{await wt(r(k).trim(),r(F),r(q)),i(k,""),await l.refreshHeaterSchedules()}catch(e){console.error(e)}i(v,!1)}}async function Ie(e){await St(e),await l.refreshHeaterSchedules()}async function Ee(e){await Ot(e),await l.refreshHeaterSchedules()}async function Fe(){await Ct(),await l.refreshPendingHeater()}function qe(e){i(C,e.id,!0),i(j,e.target_temp,!0)}async function ze(e){await $t(e,r(j)),i(C,null),await l.refreshHeaterPresets()}function Le(){i(C,null)}let z=g(!1),M=g(""),I=g(""),B=g(20);async function Re(){if(!(!r(M).trim()||!r(I).trim())){i(v,!0);try{const e=r(M).trim().toLowerCase().replace(/\s+/g,"-");await Pt(e,r(I).trim(),r(B)),i(M,""),i(I,""),i(B,20),i(z,!1),await l.refreshHeaterPresets()}catch(e){console.error(e),alert(e.message||"Failed to create preset")}i(v,!1)}}async function Ue(e){if(confirm(`Delete preset "${e}"? This will also delete any schedules using this preset.`)){i(v,!0);try{await kt(e),await l.refreshHeaterPresets(),await l.refreshHeaterSchedules()}catch(t){console.error(t)}i(v,!1)}}async function Xe(e){i(v,!0);try{const t=await Ht(e);console.log("Applied preset:",t),await l.refreshPendingHeater()}catch(t){console.error(t)}i(v,!1)}function ge(e){const t=l.heaterPresets.find(o=>o.id===e);return(t==null?void 0:t.name)??e}var Z=Yt();At("1wpfyiy",e=>{_t(()=>{bt.title="Smart Home - Heater Schedule"})});var G=s(Z),ee=s(G),te=s(ee),Be=s(te);Et(Be,{class:"w-5 h-5"}),A(),a(te);var L=n(te,2);L.__click=De;var Ge=s(L,!0);a(L),a(ee);var he=n(ee,2);{var Je=e=>{var t=Ft();f(e,t)};T(he,e=>{var t;(t=l.heaterOverride)!=null&&t.enabled&&e(Je)})}var ye=n(he,2),re=s(ye),ae=s(re),se=s(ae);P(se),se.__change=()=>{i(H,"pause"),Y("pause")},A(2),a(ae);var we=n(ae,2),ne=s(we);P(ne),ne.__change=()=>{i(H,"fixed"),Y("fixed")},A(2),a(we),a(re);var Ke=n(re,2);{var Qe=e=>{var t=qt(),o=s(t);P(o),o.__change=()=>Y();var c=n(o,2),d=s(c);a(c),a(t),S(()=>_(d,`${r(D)??""}°C`)),N(o,()=>r(D),p=>i(D,p)),f(e,t)};T(Ke,e=>{r(H)==="fixed"&&e(Qe)})}a(ye),a(G);var oe=n(G,2),ie=s(oe),ce=s(ie),Ve=s(ce);Dt(Ve,{class:"w-5 h-5"}),A(),a(ce);var le=n(ce,2);le.__click=()=>i(z,!r(z));var We=s(le);je(We,{class:"w-4 h-4"}),A(),a(le),a(ie);var Pe=n(ie,2);{var Ye=e=>{var t=zt(),o=s(t),c=s(o);P(c);var d=n(c,2);P(d);var p=n(d,2),x=s(p);P(x),A(2),a(p);var h=n(p,2);h.__click=Re;var b=n(h,2);b.__click=()=>i(z,!1);var $=s(b);Ne($,{class:"w-5 h-5"}),a(b),a(o),a(t),S(u=>h.disabled=u,[()=>r(v)||!r(M).trim()||!r(I).trim()]),N(c,()=>r(M),u=>i(M,u)),N(d,()=>r(I),u=>i(I,u)),N(x,()=>r(B),u=>i(B,u)),f(e,t)};T(Pe,e=>{r(z)&&e(Ye)})}var ke=n(Pe,2);Q(ke,21,()=>l.heaterPresets,e=>e.id,(e,t)=>{var o=Ut(),c=s(o);c.__click=()=>Ue(r(t).id);var d=s(c);Ne(d,{class:"w-3 h-3"}),a(c);var p=n(c,2),x=s(p),h=s(x,!0);a(x);var b=n(x,2);b.__click=()=>Xe(r(t).id);var $=s(b);Tt($,{class:"w-4 h-4"}),a(b),a(p);var u=n(p,2);{var R=O=>{var y=Lt(),w=s(y);P(w);var K=n(w,4);K.__click=()=>ze(r(t).id);var U=n(K,2);U.__click=Le,a(y),N(w,()=>r(j),be=>i(j,be)),f(O,y)},E=O=>{var y=Rt();y.__click=()=>qe(r(t));var w=s(y);a(y),S(()=>_(w,`${r(t).target_temp??""}°C`)),f(O,y)};T(u,O=>{r(C)===r(t).id?O(R):O(E,!1)})}a(o),S(()=>{_(h,r(t).name),b.disabled=r(v)}),f(e,o)}),a(ke),a(oe);var de=n(oe,2),ve=s(de),Ze=s(ve);je(Ze,{class:"w-5 h-5"}),A(),a(ve);var He=n(ve,2),pe=s(He);P(pe);var ue=n(pe,2),J=s(ue);Q(J,21,()=>l.heaterPresets,e=>e.id,(e,t)=>{var o=Xt(),c=s(o);a(o);var d={};S(()=>{_(c,`${r(t).name??""} (${r(t).target_temp??""}°C)`),d!==(d=r(t).id)&&(o.value=(o.__value=r(t).id)??"")}),f(e,o)}),a(J);var $e=n(J,2);P($e),a(ue);var Oe=n(ue,2);Oe.__click=Me,a(He),a(de);var fe=n(de,2),me=s(fe),Se=s(me);Mt(Se,{class:"w-5 h-5"});var et=n(Se);a(me);var tt=n(me,2);{var rt=e=>{var t=Bt();f(e,t)},at=e=>{var t=Jt();Q(t,21,()=>l.heaterSchedules,o=>o.id,(o,c)=>{var d=Gt();let p;var x=s(d),h=s(x),b=s(h,!0);a(h);var $=n(h,2),u=s($),R=s(u,!0);a(u);var E=n(u,2),O=s(E);a(E),a($),a(x);var y=n(x,2),w=s(y);w.__click=()=>Ee(r(c).id);var K=s(w,!0);a(w);var U=n(w,2);U.__click=()=>Ie(r(c).id);var be=s(U);It(be,{class:"w-4 h-4"}),a(U),a(y),a(d),S(dt=>{p=V(d,1,"bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between",null,p,{"opacity-50":!r(c).enabled}),_(b,r(c).time),_(R,r(c).name),_(O,`(${dt??""})`),V(w,1,`text-sm px-3 py-1 rounded-lg font-medium transition-colors
                       ${r(c).enabled?"bg-success/20 text-success":"bg-surface-recessed text-content-secondary"}`),_(K,r(c).enabled?"On":"Off")},[()=>ge(r(c).preset_id)]),f(o,d)}),a(t),f(e,t)};T(tt,e=>{l.heaterSchedules.length===0?e(rt):e(at,!1)})}a(fe);var Ce=n(fe,2),xe=s(Ce),_e=s(xe),st=s(_e);a(_e);var nt=n(_e,2);{var ot=e=>{var t=Kt();t.__click=Fe,f(e,t)};T(nt,e=>{l.pendingHeaterActions.length>0&&e(ot)})}a(xe);var it=n(xe,2);{var ct=e=>{var t=Qt();f(e,t)},lt=e=>{var t=Wt();Q(t,21,()=>l.pendingHeaterActions,o=>o.id,(o,c)=>{var d=Vt(),p=s(d),x=s(p),h=s(x,!0);a(x);var b=n(x,2),$=s(b);a(b),a(p);var u=n(p,2),R=s(u);a(u),a(d),S(E=>{_(h,r(c).device_id),_($,`→ ${E??""}`),_(R,`Retry #${r(c).retry_count??""}`)},[()=>ge(r(c).preset_id)]),f(o,d)}),a(t),f(e,t)};T(it,e=>{l.pendingHeaterActions.length===0?e(ct):e(lt,!1)})}a(Ce),a(Z),S(e=>{var t,o,c;V(G,1,`bg-surface-elevated border rounded-xl p-4 ${(t=l.heaterOverride)!=null&&t.enabled?"border-warning":"border-stroke-default"}`),L.disabled=r(v),V(L,1,`px-4 py-2 rounded-lg font-medium transition-colors disabled:opacity-50
               ${(o=l.heaterOverride)!=null&&o.enabled?"bg-warning text-white hover:bg-warning/80":"bg-surface-recessed text-content-secondary hover:bg-stroke-default"}`),_(Ge,(c=l.heaterOverride)!=null&&c.enabled?"Active":"Off"),Te(se,r(H)==="pause"),Te(ne,r(H)==="fixed"),Oe.disabled=e,_(et,` Schedules (${l.heaterSchedules.length??""})`),_(st,`Pending Actions (${l.pendingHeaterActions.length??""})`)},[()=>r(v)||!r(k).trim()]),N(pe,()=>r(k),e=>i(k,e)),yt(J,()=>r(F),e=>i(F,e)),N($e,()=>r(q),e=>i(q,e)),f(W,Z),xt()}pt(["click","change"]);export{cr as component};
