import{d as bt,f as g,a as b,s as v}from"../chunks/CEDFY9N9.js";import{p as gt,s as u,a as yt,b as ht,c,d as n,g as t,t as j,h as wt,e as Pt,i as r,$ as kt,n as J,j as a,k as Ne,l as Oe}from"../chunks/B2drfW2D.js";import{i as E}from"../chunks/Bro-wCEF.js";import{e as ee,b as $t,c as St,a as h,g as Ct,r as S,d as Be,f as At,h as jt,i as Lt,u as Tt,t as Dt,j as Nt,k as Ot}from"../chunks/B0b-N5Ls.js";import{c as Bt}from"../chunks/DIqNBuPr.js";import{h as Kt,b as N,X as Ke,a as Re,P as Rt}from"../chunks/Dx7yjh-j.js";import{b as Et}from"../chunks/Diics1BE.js";import{L as Ee,M as Ft,S as It}from"../chunks/Df0L0eCz.js";import{P as Fe,C as Mt,T as Ht}from"../chunks/AqStGfDT.js";import{P as Xt}from"../chunks/D7d8s7vl.js";var qt=g('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-4 mb-4"><div class="flex flex-col gap-3"><div class="flex flex-col sm:flex-row gap-3"><input type="text" placeholder="Preset ID (e.g. reading)" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary placeholder:text-content-tertiary flex-1"/> <input type="text" placeholder="Display name (e.g. Reading)" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary placeholder:text-content-tertiary flex-1"/></div> <div class="flex flex-wrap items-center gap-4"><label class="flex items-center gap-2"><input type="checkbox" class="accent-accent"/> <span class="text-content-primary">Power On</span></label> <div class="flex items-center gap-2"><span class="text-content-secondary text-sm">Brightness:</span> <input type="range" min="1" max="100" class="w-24 accent-accent"/> <span class="text-content-primary w-12"> </span></div> <div class="flex items-center gap-2"><span class="text-content-secondary text-sm">Color:</span> <input type="range" min="2700" max="6500" step="100" class="w-24 accent-accent"/> <span class="text-content-primary w-16"> </span></div></div> <div class="flex gap-2"><button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium">Create</button> <button class="px-3 py-2 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors"><!></button></div></div></div>'),zt=g('<div class="space-y-2"><label class="flex items-center gap-2"><input type="checkbox" class="accent-accent"/> <span class="text-sm text-content-primary">Power</span></label> <div class="flex items-center gap-2"><input type="range" min="1" max="100" class="w-full accent-accent"/> <span class="text-sm text-content-primary w-10"> </span></div> <div class="flex items-center gap-2"><input type="range" min="2700" max="6500" step="100" class="w-full accent-accent"/> <span class="text-sm text-content-primary w-14"> </span></div> <div class="flex gap-2 mt-2"><button class="text-xs px-2 py-1 bg-success/20 text-success rounded disabled:opacity-50">Save</button> <button class="text-xs px-2 py-1 bg-surface-recessed text-content-secondary rounded">Cancel</button></div></div>'),Gt=g('<button class="text-sm text-content-secondary hover:text-accent transition-colors"> </button>'),Jt=g('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-4 relative group"><button class="absolute top-2 right-2 p-1 rounded bg-error/20 text-error opacity-0 group-hover:opacity-100 transition-opacity" title="Delete preset"><!></button> <div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><!> <span class="font-medium text-content-primary"> </span></div> <button class="p-1.5 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors disabled:opacity-50" title="Apply to all lamps"><!></button></div> <!></div>'),Qt=g('<p class="text-sm mt-3 text-content-secondary"> </p>'),Ut=g("<option> </option>"),Vt=g('<p class="text-content-secondary">No schedules yet</p>'),Wt=g('<div><div class="flex items-center gap-4"><span class="text-xl font-mono text-content-primary"> </span> <div><span class="font-medium text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div></div> <div class="flex gap-2"><button> </button> <button class="text-sm px-3 py-1 rounded-lg bg-error/20 text-error hover:bg-error/30 font-medium transition-colors"><!></button></div></div>'),Yt=g('<div class="space-y-2"></div>'),Zt=g('<button class="text-sm px-3 py-1 rounded-lg bg-surface-recessed text-content-secondary hover:bg-stroke-default transition-colors">Clear All</button>'),ea=g('<p class="text-content-secondary">No pending actions (all lamps online)</p>'),ta=g('<div class="bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between"><div><span class="font-mono text-sm text-content-primary"> </span> <span class="text-sm text-content-secondary ml-2"> </span></div> <span class="text-xs text-content-tertiary"> </span></div>'),aa=g('<div class="space-y-2"></div>'),ra=g('<div class="space-y-8"><section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary flex items-center gap-2"><!> Lamp Presets</h2> <button class="text-sm px-3 py-1.5 rounded-lg bg-accent/20 text-accent hover:bg-accent/30 transition-colors flex items-center gap-1"><!> Add Preset</button></div> <!> <div class="grid grid-cols-2 sm:grid-cols-4 gap-3"></div> <!></section> <section class="bg-surface-elevated border border-stroke-default rounded-xl p-4"><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> Create Schedule</h2> <div class="flex flex-col sm:flex-row flex-wrap gap-3"><input type="text" placeholder="Schedule name" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 w-full sm:flex-1 sm:min-w-[150px] text-content-primary placeholder:text-content-tertiary"/> <div class="flex gap-3"><select class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary flex-1 sm:flex-initial"></select> <input type="time" class="bg-surface-recessed border border-stroke-default rounded-lg px-3 py-2 text-content-primary"/></div> <button class="bg-accent hover:bg-accent/80 disabled:opacity-50 px-4 py-2 rounded-lg text-white font-medium w-full sm:w-auto">Add</button></div></section> <section><h2 class="text-lg font-medium text-content-primary mb-4 flex items-center gap-2"><!> </h2> <!></section> <section><div class="flex items-center justify-between mb-4"><h2 class="text-lg font-medium text-content-primary"> </h2> <!></div> <!></section></div>');function ma(Ie,Me){gt(Me,!0);let Q=u(yt({})),te=u(null),F=u(null),B=u(""),ae=u("night"),re=u("19:00"),P=u(!1),U=u(null),I=u(100),M=u(4e3),V=u(!0),H=u(!1),K=u(""),R=u(""),X=u(100),q=u(4e3),W=u(!0);async function Y(){c(Q,await Ct(),!0)}ht(()=>{Et&&Y()});function He(e){switch(e){case"day":return It;case"night":return Ft;case"off":return Xt;default:return Ee}}async function Xe(e){c(te,e,!0),c(F,null);try{c(F,await Lt(e),!0),h.refreshPending()}catch(s){console.error(s)}c(te,null)}function qe(e,s){c(U,e,!0),c(I,s.brightness,!0),c(M,s.colorTemp,!0),c(V,s.power,!0)}async function ze(e){c(P,!0);try{await Tt(e,t(I),t(M),t(V)),c(U,null),await Y()}catch(s){console.error(s)}c(P,!1)}function Ge(){c(U,null)}async function Je(){if(!(!t(K).trim()||!t(R).trim())){c(P,!0);try{const e=t(K).trim().toLowerCase().replace(/\s+/g,"-");await At(e,t(R).trim(),t(X),t(q),t(W)),c(K,""),c(R,""),c(X,100),c(q,4e3),c(W,!0),c(H,!1),await Y()}catch(e){console.error(e),alert(e.message||"Failed to create preset")}c(P,!1)}}async function Qe(e){if(confirm(`Delete preset "${e}"? This will also delete any schedules using this preset.`)){c(P,!0);try{await jt(e),await Y(),await h.refreshSchedules()}catch(s){console.error(s)}c(P,!1)}}async function Ue(){if(t(B).trim()){c(P,!0);try{await St(t(B).trim(),t(ae),t(re)),c(B,""),await h.refreshSchedules()}catch(e){console.error(e)}c(P,!1)}}async function Ve(e){await Nt(e),await h.refreshSchedules()}async function We(e){await Dt(e),await h.refreshSchedules()}async function Ye(){await Ot(),await h.refreshPending()}function Pe(e){const s=t(Q)[e];return(s==null?void 0:s.name)??e}var se=ra();Kt("92554t",e=>{Pt(()=>{kt.title="Smart Home - Lighting"})});var ne=r(se),ce=r(ne),oe=r(ce),Ze=r(oe);Ee(Ze,{class:"w-5 h-5"}),J(),a(oe);var le=n(oe,2);le.__click=()=>c(H,!t(H));var et=r(le);Fe(et,{class:"w-4 h-4"}),J(),a(le),a(ce);var ke=n(ce,2);{var tt=e=>{var s=qt(),d=r(s),o=r(d),l=r(o);S(l);var i=n(l,2);S(i),a(o);var p=n(o,2),x=r(p),k=r(x);S(k),J(2),a(x);var w=n(x,2),y=n(r(w),2);S(y);var C=n(y,2),L=r(C);a(C),a(w);var A=n(w,2),T=n(r(A),2);S(T);var $=n(T,2),z=r($);a($),a(A),a(p);var D=n(p,2),f=r(D);f.__click=Je;var m=n(f,2);m.__click=()=>c(H,!1);var O=r(m);Ke(O,{class:"w-5 h-5"}),a(m),a(D),a(d),a(s),j(_=>{v(L,`${t(X)??""}%`),v(z,`${t(q)??""}K`),f.disabled=_},[()=>t(P)||!t(K).trim()||!t(R).trim()]),N(l,()=>t(K),_=>c(K,_)),N(i,()=>t(R),_=>c(R,_)),Re(k,()=>t(W),_=>c(W,_)),N(y,()=>t(X),_=>c(X,_)),N(T,()=>t(q),_=>c(q,_)),b(e,s)};E(ke,e=>{t(H)&&e(tt)})}var ie=n(ke,2);ee(ie,21,()=>Object.entries(t(Q)),([e,s])=>e,(e,s)=>{var d=Ne(()=>Oe(t(s),2));let o=()=>t(d)[0],l=()=>t(d)[1];var i=Jt(),p=r(i);p.__click=()=>Qe(o());var x=r(p);Ke(x,{class:"w-3 h-3"}),a(p);var k=n(p,2),w=r(k),y=r(w);Bt(y,()=>He(o()),(f,m)=>{m(f,{class:"w-5 h-5 text-accent"})});var C=n(y,2),L=r(C,!0);a(C),a(w);var A=n(w,2);A.__click=()=>Xe(o());var T=r(A);Rt(T,{class:"w-4 h-4"}),a(A),a(k);var $=n(k,2);{var z=f=>{var m=zt(),O=r(m),_=r(O);S(_),J(2),a(O);var be=n(O,2),ge=r(be);S(ge);var Le=n(ge,2),xt=r(Le);a(Le),a(be);var ye=n(be,2),he=r(ye);S(he);var Te=n(he,2),ft=r(Te);a(Te),a(ye);var De=n(ye,2),we=r(De);we.__click=()=>ze(o());var _t=n(we,2);_t.__click=Ge,a(De),a(m),j(()=>{v(xt,`${t(I)??""}%`),v(ft,`${t(M)??""}K`),we.disabled=t(P)}),Re(_,()=>t(V),G=>c(V,G)),N(ge,()=>t(I),G=>c(I,G)),N(he,()=>t(M),G=>c(M,G)),b(f,m)},D=f=>{var m=Gt();m.__click=()=>qe(o(),l());var O=r(m,!0);a(m),j(()=>v(O,l().power?`${l().brightness}% / ${l().colorTemp}K`:"Off")),b(f,m)};E($,f=>{t(U)===o()?f(z):f(D,!1)})}a(i),j(()=>{v(L,l().name),A.disabled=t(te)!==null}),b(e,i)}),a(ie);var at=n(ie,2);{var rt=e=>{var s=Qt(),d=r(s);a(s),j(()=>v(d,`Last apply: ${t(F).success.length??""} ok, ${t(F).pending.length??""} pending`)),b(e,s)};E(at,e=>{t(F)&&e(rt)})}a(ne);var de=n(ne,2),pe=r(de),st=r(pe);Fe(st,{class:"w-5 h-5"}),J(),a(pe);var $e=n(pe,2),ve=r($e);S(ve);var ue=n(ve,2),Z=r(ue);ee(Z,21,()=>Object.entries(t(Q)),([e,s])=>e,(e,s)=>{var d=Ne(()=>Oe(t(s),2));let o=()=>t(d)[0],l=()=>t(d)[1];var i=Ut(),p=r(i,!0);a(i);var x={};j(()=>{v(p,l().name),x!==(x=o())&&(i.value=(i.__value=o())??"")}),b(e,i)}),a(Z);var Se=n(Z,2);S(Se),a(ue);var Ce=n(ue,2);Ce.__click=Ue,a($e),a(de);var me=n(de,2),xe=r(me),Ae=r(xe);Mt(Ae,{class:"w-5 h-5"});var nt=n(Ae);a(xe);var ct=n(xe,2);{var ot=e=>{var s=Vt();b(e,s)},lt=e=>{var s=Yt();ee(s,21,()=>h.schedules,d=>d.id,(d,o)=>{var l=Wt();let i;var p=r(l),x=r(p),k=r(x,!0);a(x);var w=n(x,2),y=r(w),C=r(y,!0);a(y);var L=n(y,2),A=r(L);a(L),a(w),a(p);var T=n(p,2),$=r(T);$.__click=()=>We(t(o).id);var z=r($,!0);a($);var D=n($,2);D.__click=()=>Ve(t(o).id);var f=r(D);Ht(f,{class:"w-4 h-4"}),a(D),a(T),a(l),j(m=>{i=Be(l,1,"bg-surface-elevated border border-stroke-default rounded-xl p-3 flex items-center justify-between",null,i,{"opacity-50":!t(o).enabled}),v(k,t(o).time),v(C,t(o).name),v(A,`(${m??""})`),Be($,1,`text-sm px-3 py-1 rounded-lg font-medium transition-colors
                       ${t(o).enabled?"bg-success/20 text-success":"bg-surface-recessed text-content-secondary"}`),v(z,t(o).enabled?"On":"Off")},[()=>Pe(t(o).preset)]),b(d,l)}),a(s),b(e,s)};E(ct,e=>{h.schedules.length===0?e(ot):e(lt,!1)})}a(me);var je=n(me,2),fe=r(je),_e=r(fe),it=r(_e);a(_e);var dt=n(_e,2);{var pt=e=>{var s=Zt();s.__click=Ye,b(e,s)};E(dt,e=>{h.pendingActions.length>0&&e(pt)})}a(fe);var vt=n(fe,2);{var ut=e=>{var s=ea();b(e,s)},mt=e=>{var s=aa();ee(s,21,()=>h.pendingActions,d=>d.id,(d,o)=>{var l=ta(),i=r(l),p=r(i),x=r(p,!0);a(p);var k=n(p,2),w=r(k);a(k),a(i);var y=n(i,2),C=r(y);a(y),a(l),j(L=>{v(x,t(o).device_id),v(w,`â†’ ${L??""}`),v(C,`Retry #${t(o).retry_count??""}`)},[()=>Pe(t(o).preset)]),b(d,l)}),a(s),b(e,s)};E(vt,e=>{h.pendingActions.length===0?e(ut):e(mt,!1)})}a(je),a(se),j(e=>{Ce.disabled=e,v(nt,` Schedules (${h.schedules.length??""})`),v(it,`Pending Actions (${h.pendingActions.length??""})`)},[()=>t(P)||!t(B).trim()]),N(ve,()=>t(B),e=>c(B,e)),$t(Z,()=>t(ae),e=>c(ae,e)),N(Se,()=>t(re),e=>c(re,e)),b(Ie,se),wt()}bt(["click"]);export{ma as component};
